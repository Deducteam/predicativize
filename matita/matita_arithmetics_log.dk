def log :
  _p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  _n:(pts.El pts.var matita_arithmetics_nat.nat) -> pts.El pts.var matita_arithmetics_nat.nat
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  matita_arithmetics_minimization.max
    n
    (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
     matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) n).

def tech_log :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) ->
  __1:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O n)) ->
  pts.El
    pts.var
    (matita_basics_logic.eq
       matita_arithmetics_nat.nat
       (log p n)
       (matita_arithmetics_minimization.max
          (matita_arithmetics_nat.S n)
          (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
           matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) n)))
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1p:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) =>
  posn:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O n)) =>
  matita_basics_logic.eq_ind_r
    matita_basics_bool.bool
    matita_basics_bool.false
    (x:(pts.El pts.var matita_basics_bool.bool) =>
     __:(pts.El
           pts.var
           (matita_basics_logic.eq matita_basics_bool.bool x matita_basics_bool.false)) =>
     matita_basics_logic.eq
       matita_arithmetics_nat.nat
       (log p n)
       (matita_basics_bool.match_bool
          pts.var
          (_0:(pts.El pts.var matita_basics_bool.bool) => matita_arithmetics_nat.nat)
          n
          (matita_arithmetics_minimization.max'
             n
             (x0:(pts.El pts.var matita_arithmetics_nat.nat) =>
              matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x0) n)
             matita_arithmetics_nat.O)
          x))
    (matita_basics_logic.refl matita_arithmetics_nat.nat (log p n))
    (matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p n) n)
    (matita_arithmetics_nat.not_le_to_leb_false
       (matita_arithmetics_exp.exp p n)
       n
       (matita_arithmetics_nat.lt_to_not_le
          n
          (matita_arithmetics_exp.exp p n)
          (matita_arithmetics_exp.lt_m_exp_nm p n lt1p))).

def le_exp_log :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O n)) ->
  pts.El pts.var (matita_arithmetics_nat.le (matita_arithmetics_exp.exp p (log p n)) n)
  :=
  a:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  posn:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O n)) =>
  matita_arithmetics_nat.leb_true_to_le
    (matita_arithmetics_exp.exp a (log a n))
    n
    (matita_arithmetics_minimization.f_max_true
       (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
        matita_arithmetics_nat.leb (matita_arithmetics_exp.exp a x) n)
       n
       (matita_basics_logic.ex_intro
          matita_arithmetics_nat.nat
          (i:(pts.El pts.var matita_arithmetics_nat.nat) =>
           matita_basics_logic.And
             (matita_arithmetics_nat.lt i n)
             (matita_basics_logic.eq
                matita_basics_bool.bool
                (matita_arithmetics_nat.leb (matita_arithmetics_exp.exp a i) n)
                matita_basics_bool.true))
          matita_arithmetics_nat.O
          (matita_basics_logic.conj
             (matita_arithmetics_nat.lt matita_arithmetics_nat.O n)
             (matita_basics_logic.eq
                matita_basics_bool.bool
                (matita_arithmetics_nat.leb
                   (matita_arithmetics_exp.exp a matita_arithmetics_nat.O)
                   n)
                matita_basics_bool.true)
             posn
             (matita_arithmetics_nat.le_to_leb_true
                (matita_arithmetics_exp.exp a matita_arithmetics_nat.O)
                n
                posn)))).

def log_SO :
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) n)) ->
  pts.El
    pts.var
    (matita_basics_logic.eq
       matita_arithmetics_nat.nat
       (log n (matita_arithmetics_nat.S matita_arithmetics_nat.O))
       matita_arithmetics_nat.O)
  :=
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1n:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) n)) =>
  matita_basics_logic.sym_eq
    matita_arithmetics_nat.nat
    matita_arithmetics_nat.O
    (log n (matita_arithmetics_nat.S matita_arithmetics_nat.O))
    (matita_arithmetics_nat.le_n_O_to_eq
       (log n (matita_arithmetics_nat.S matita_arithmetics_nat.O))
       (matita_arithmetics_exp.le_exp_to_le
          n
          (log n (matita_arithmetics_nat.S matita_arithmetics_nat.O))
          matita_arithmetics_nat.O
          lt1n
          (matita_arithmetics_nat.le_n
             (matita_arithmetics_exp.exp
                n
                (log n (matita_arithmetics_nat.S matita_arithmetics_nat.O)))))).

def lt_to_log_O :
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  m:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O m)) ->
  __1:(pts.El pts.var (matita_arithmetics_nat.lt m n)) ->
  pts.El
    pts.var
    (matita_basics_logic.eq matita_arithmetics_nat.nat (log n m) matita_arithmetics_nat.O)
  :=
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  m:(pts.El pts.var matita_arithmetics_nat.nat) =>
  posm:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O m)) =>
  ltnm:(pts.El pts.var (matita_arithmetics_nat.lt m n)) =>
  matita_basics_logic.sym_eq
    matita_arithmetics_nat.nat
    matita_arithmetics_nat.O
    (log n m)
    (matita_arithmetics_nat.le_n_O_to_eq
       (log n m)
       (matita_arithmetics_nat.le_S_S_to_le
          (log n m)
          matita_arithmetics_nat.O
          (matita_arithmetics_exp.lt_exp_to_lt
             n
             (log n m)
             (matita_arithmetics_nat.S matita_arithmetics_nat.O)
             (matita_arithmetics_nat.le_to_lt_to_lt
                matita_arithmetics_nat.O
                m
                n
                (matita_arithmetics_nat.le_O_n m)
                ltnm)
             (matita_basics_logic.eq_ind
                matita_arithmetics_nat.nat
                n
                (x_1:(pts.El pts.var matita_arithmetics_nat.nat) =>
                 _x_2:(pts.El
                         pts.var
                         (matita_basics_logic.eq matita_arithmetics_nat.nat n x_1)) =>
                 matita_arithmetics_nat.lt (matita_arithmetics_exp.exp n (log n m)) x_1)
                (matita_arithmetics_nat.le_to_lt_to_lt
                   (matita_arithmetics_exp.exp n (log n m))
                   m
                   n
                   (le_exp_log n m posm)
                   ltnm)
                (matita_arithmetics_nat.plus n matita_arithmetics_nat.O)
                (matita_arithmetics_nat.plus_n_O n))))).

def lt_log_n_n :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) ->
  __1:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O n)) ->
  pts.El pts.var (matita_arithmetics_nat.lt (log p n) n)
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1p:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) =>
  posn:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O n)) =>
  matita_basics_logic.Or_ind
    (matita_arithmetics_nat.lt (log p n) n)
    (matita_basics_logic.eq matita_arithmetics_nat.nat (log p n) n)
    (_x_170:(pts.El
               pts.var
               (matita_basics_logic.Or
                  (matita_arithmetics_nat.lt (log p n) n)
                  (matita_basics_logic.eq matita_arithmetics_nat.nat (log p n) n))) =>
     matita_arithmetics_nat.lt (log p n) n)
    (_x_171:(pts.El pts.var (matita_arithmetics_nat.lt (log p n) n)) => _x_171)
    (Hn:(pts.El pts.var (matita_basics_logic.eq matita_arithmetics_nat.nat (log p n) n)) =>
     matita_basics_logic.False_ind
       (_x_66:(pts.El pts.var matita_basics_logic.False) => matita_arithmetics_nat.lt (log p n) n)
       (matita_basics_logic.absurd
          (matita_arithmetics_nat.le (matita_arithmetics_exp.exp p n) n)
          (matita_basics_logic.eq_ind
             matita_arithmetics_nat.nat
             (log p n)
             (x_1:(pts.El pts.var matita_arithmetics_nat.nat) =>
              _x_2:(pts.El
                      pts.var
                      (matita_basics_logic.eq matita_arithmetics_nat.nat (log p n) x_1)) =>
              matita_arithmetics_nat.le (matita_arithmetics_exp.exp p x_1) n)
             (le_exp_log p n posn)
             n
             Hn)
          (matita_arithmetics_nat.lt_to_not_le
             n
             (matita_arithmetics_exp.exp p n)
             (matita_arithmetics_exp.lt_m_exp_nm p n lt1p))))
    (matita_arithmetics_nat.le_to_or_lt_eq
       (log p n)
       n
       (matita_arithmetics_minimization.le_max_n
          (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
           matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) n)
          n)).

def lt_O_log :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) n)) ->
  __1:(pts.El pts.var (matita_arithmetics_nat.le p n)) ->
  pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O (log p n))
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1p:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) n)) =>
  lepn:(pts.El pts.var (matita_arithmetics_nat.le p n)) =>
  matita_arithmetics_nat.not_lt_to_le
    (matita_arithmetics_minimization.max'
       n
       (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
        matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) n)
       matita_arithmetics_nat.O)
    (matita_arithmetics_nat.S matita_arithmetics_nat.O)
    (matita_basics_logic.nmk
       (matita_arithmetics_nat.lt
          (matita_arithmetics_minimization.max'
             n
             (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
              matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) n)
             matita_arithmetics_nat.O)
          (matita_arithmetics_nat.S matita_arithmetics_nat.O))
       (H:(pts.El
             pts.var
             (matita_arithmetics_nat.lt
                (matita_arithmetics_minimization.max'
                   n
                   (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                    matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) n)
                   matita_arithmetics_nat.O)
                (matita_arithmetics_nat.S matita_arithmetics_nat.O))) =>
        matita_basics_logic.eq_ind
          matita_arithmetics_nat.nat
          p
          (x_1:(pts.El pts.var matita_arithmetics_nat.nat) =>
           _x_2:(pts.El pts.var (matita_basics_logic.eq matita_arithmetics_nat.nat p x_1)) =>
           pts.Prod
             pts.var
             pts.var
             (matita_basics_logic.eq
                matita_basics_bool.bool
                (matita_arithmetics_nat.leb x_1 n)
                matita_basics_bool.false)
             (__:(pts.El
                    pts.var
                    (matita_basics_logic.eq
                       matita_basics_bool.bool
                       (matita_arithmetics_nat.leb x_1 n)
                       matita_basics_bool.false)) =>
              matita_basics_logic.False))
          (matita_basics_logic.eq_ind_r
             matita_basics_bool.bool
             matita_basics_bool.true
             (x:(pts.El pts.var matita_basics_bool.bool) =>
              __:(pts.El
                    pts.var
                    (matita_basics_logic.eq matita_basics_bool.bool x matita_basics_bool.true)) =>
              pts.Prod
                pts.var
                pts.var
                (matita_basics_logic.eq matita_basics_bool.bool x matita_basics_bool.false)
                (__1:(pts.El
                        pts.var
                        (matita_basics_logic.eq
                           matita_basics_bool.bool
                           x
                           matita_basics_bool.false)) =>
                 matita_basics_logic.False))
             (H0:(pts.El
                    pts.var
                    (matita_basics_logic.eq
                       matita_basics_bool.bool
                       matita_basics_bool.true
                       matita_basics_bool.false)) =>
              matita_basics_bool.bool_discr
                matita_basics_bool.true
                matita_basics_bool.false
                H0
                matita_basics_logic.False)
             (matita_arithmetics_nat.leb p n)
             (matita_arithmetics_nat.le_to_leb_true p n lepn))
          (matita_arithmetics_exp.exp p (matita_arithmetics_nat.S matita_arithmetics_nat.O))
          (matita_arithmetics_exp.exp_n_1 p)
          (matita_arithmetics_minimization.lt_max_to_false
             (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
              matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) n)
             n
             (matita_arithmetics_nat.S matita_arithmetics_nat.O)
             lt1p
             H))).

def le_log_n_n :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) ->
  pts.El pts.var (matita_arithmetics_nat.le (log p n) n)
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1p:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) =>
  matita_arithmetics_nat.match_nat
    pts.var
    (__:(pts.El pts.var matita_arithmetics_nat.nat) => matita_arithmetics_nat.le (log p __) __)
    (matita_arithmetics_nat.le_n (log p matita_arithmetics_nat.O))
    (m:(pts.El pts.var matita_arithmetics_nat.nat) =>
     matita_arithmetics_nat.lt_to_le
       (log p (matita_arithmetics_nat.S m))
       (matita_arithmetics_nat.S m)
       (lt_log_n_n p (matita_arithmetics_nat.S m) lt1p (matita_arithmetics_nat.lt_O_S m)))
    n.

def let_clause_1033 :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  lt1p:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) ->
  m:(pts.El pts.var matita_arithmetics_nat.nat) ->
  x2515:(pts.El pts.var matita_arithmetics_nat.nat) ->
  x2516:(pts.El pts.var matita_arithmetics_nat.nat) ->
  pts.El
    pts.var
    (matita_basics_logic.eq
       matita_arithmetics_nat.nat
       x2515
       (matita_arithmetics_nat.plus
          (matita_arithmetics_nat.times x2516 (matita_arithmetics_div_and_mod.div x2515 x2516))
          (matita_arithmetics_div_and_mod.mod x2515 x2516)))
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1p:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) =>
  m:(pts.El pts.var matita_arithmetics_nat.nat) =>
  x2515:(pts.El pts.var matita_arithmetics_nat.nat) =>
  x2516:(pts.El pts.var matita_arithmetics_nat.nat) =>
  matita_basics_logic.rewrite_l
    matita_arithmetics_nat.nat
    (matita_arithmetics_nat.times (matita_arithmetics_div_and_mod.div x2515 x2516) x2516)
    (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
     matita_basics_logic.eq
       matita_arithmetics_nat.nat
       x2515
       (matita_arithmetics_nat.plus __ (matita_arithmetics_div_and_mod.mod x2515 x2516)))
    (matita_arithmetics_div_and_mod.div_mod x2515 x2516)
    (matita_arithmetics_nat.times x2516 (matita_arithmetics_div_and_mod.div x2515 x2516))
    (matita_arithmetics_nat.commutative_times (matita_arithmetics_div_and_mod.div x2515 x2516) x2516).

def lt_exp_log :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) ->
  pts.El
    pts.var
    (matita_arithmetics_nat.lt n (matita_arithmetics_exp.exp p (matita_arithmetics_nat.S (log p n))))
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1p:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) =>
  matita_arithmetics_nat.match_nat
    pts.var
    (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
     matita_arithmetics_nat.lt
       __
       (matita_arithmetics_exp.exp p (matita_arithmetics_nat.S (log p __))))
    (matita_basics_logic.eq_ind
       matita_arithmetics_nat.nat
       p
       (x_1:(pts.El pts.var matita_arithmetics_nat.nat) =>
        _x_2:(pts.El pts.var (matita_basics_logic.eq matita_arithmetics_nat.nat p x_1)) =>
        matita_arithmetics_nat.le (matita_arithmetics_nat.S matita_arithmetics_nat.O) x_1)
       (matita_arithmetics_nat.lt_to_le (matita_arithmetics_nat.S matita_arithmetics_nat.O) p lt1p)
       (matita_arithmetics_nat.plus p matita_arithmetics_nat.O)
       (matita_arithmetics_nat.plus_n_O p))
    (m:(pts.El pts.var matita_arithmetics_nat.nat) =>
     matita_arithmetics_nat.not_le_to_lt
       (matita_arithmetics_exp.exp p (matita_arithmetics_nat.S (log p (matita_arithmetics_nat.S m))))
       (matita_arithmetics_nat.S m)
       (matita_arithmetics_nat.leb_false_to_not_le
          (matita_arithmetics_exp.exp
             p
             (matita_arithmetics_nat.S (log p (matita_arithmetics_nat.S m))))
          (matita_arithmetics_nat.S m)
          (matita_arithmetics_minimization.lt_max_to_false
             (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
              matita_arithmetics_nat.leb
                (matita_arithmetics_exp.exp p __)
                (matita_arithmetics_nat.S m))
             (matita_arithmetics_nat.S (matita_arithmetics_nat.S m))
             (matita_arithmetics_nat.S (log p (matita_arithmetics_nat.S m)))
             (matita_arithmetics_nat.le_S_S
                (matita_arithmetics_nat.S (log p (matita_arithmetics_nat.S m)))
                (matita_arithmetics_nat.S m)
                (lt_log_n_n p (matita_arithmetics_nat.S m) lt1p (matita_arithmetics_nat.lt_O_S m)))
             (matita_basics_logic.eq_ind
                matita_arithmetics_nat.nat
                (log p (matita_arithmetics_nat.S m))
                (x_1:(pts.El pts.var matita_arithmetics_nat.nat) =>
                 _x_2:(pts.El
                         pts.var
                         (matita_basics_logic.eq
                            matita_arithmetics_nat.nat
                            (log p (matita_arithmetics_nat.S m))
                            x_1)) =>
                 matita_arithmetics_nat.lt
                   x_1
                   (matita_arithmetics_nat.S (log p (matita_arithmetics_nat.S m))))
                (matita_basics_logic.eq_coerc
                   (matita_arithmetics_nat.lt
                      (matita_arithmetics_div_and_mod.mod
                         (log p (matita_arithmetics_nat.S m))
                         matita_arithmetics_nat.O)
                      (matita_arithmetics_nat.plus
                         (matita_arithmetics_nat.plus
                            (matita_arithmetics_div_and_mod.mod
                               (log p (matita_arithmetics_nat.S m))
                               matita_arithmetics_nat.O)
                            (matita_arithmetics_nat.times
                               matita_arithmetics_nat.O
                               (matita_arithmetics_div_and_mod.div
                                  (log p (matita_arithmetics_nat.S m))
                                  matita_arithmetics_nat.O)))
                         (matita_arithmetics_nat.S matita_arithmetics_nat.O)))
                   (matita_arithmetics_nat.lt
                      (log p (matita_arithmetics_nat.S m))
                      (matita_arithmetics_nat.S (log p (matita_arithmetics_nat.S m))))
                   (matita_arithmetics_nat.lt_plus_Sn_r
                      (matita_arithmetics_div_and_mod.mod
                         (log p (matita_arithmetics_nat.S m))
                         matita_arithmetics_nat.O)
                      (matita_arithmetics_nat.times
                         matita_arithmetics_nat.O
                         (matita_arithmetics_div_and_mod.div
                            (log p (matita_arithmetics_nat.S m))
                            matita_arithmetics_nat.O))
                      matita_arithmetics_nat.O)
                   (matita_basics_logic.rewrite_l
                      matita_arithmetics_nat.nat
                      (log p (matita_arithmetics_nat.S m))
                      (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                       matita_basics_logic.eq
                         (pts.u pts.var)
                         (matita_arithmetics_nat.lt
                            (matita_arithmetics_div_and_mod.mod
                               (log p (matita_arithmetics_nat.S m))
                               matita_arithmetics_nat.O)
                            (matita_arithmetics_nat.plus
                               __
                               (matita_arithmetics_nat.S matita_arithmetics_nat.O)))
                         (matita_arithmetics_nat.lt
                            (log p (matita_arithmetics_nat.S m))
                            (matita_arithmetics_nat.S (log p (matita_arithmetics_nat.S m)))))
                      (matita_basics_logic.rewrite_l
                         matita_arithmetics_nat.nat
                         (log p (matita_arithmetics_nat.S m))
                         (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                          matita_basics_logic.eq
                            (pts.u pts.var)
                            (matita_arithmetics_nat.lt
                               __
                               (matita_arithmetics_nat.plus
                                  (log p (matita_arithmetics_nat.S m))
                                  (matita_arithmetics_nat.S matita_arithmetics_nat.O)))
                            (matita_arithmetics_nat.lt
                               (log p (matita_arithmetics_nat.S m))
                               (matita_arithmetics_nat.S
                                  (log p (matita_arithmetics_nat.S m)))))
                         (matita_basics_logic.rewrite_l
                            matita_arithmetics_nat.nat
                            (matita_arithmetics_nat.S (log p (matita_arithmetics_nat.S m)))
                            (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                             matita_basics_logic.eq
                               (pts.u pts.var)
                               (matita_arithmetics_nat.lt
                                  (log p (matita_arithmetics_nat.S m))
                                  __)
                               (matita_arithmetics_nat.lt
                                  (log p (matita_arithmetics_nat.S m))
                                  (matita_arithmetics_nat.S
                                     (log p (matita_arithmetics_nat.S m)))))
                            (matita_basics_logic.refl
                               (pts.u pts.var)
                               (matita_arithmetics_nat.lt
                                  (log p (matita_arithmetics_nat.S m))
                                  (matita_arithmetics_nat.S
                                     (log p (matita_arithmetics_nat.S m)))))
                            (matita_arithmetics_nat.plus
                               (log p (matita_arithmetics_nat.S m))
                               (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                            (matita_basics_logic.rewrite_r
                               matita_arithmetics_nat.nat
                               (matita_arithmetics_nat.plus
                                  (log p (matita_arithmetics_nat.S m))
                                  matita_arithmetics_nat.O)
                               (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                                matita_basics_logic.eq
                                  matita_arithmetics_nat.nat
                                  (matita_arithmetics_nat.S __)
                                  (matita_arithmetics_nat.plus
                                     (log p (matita_arithmetics_nat.S m))
                                     (matita_arithmetics_nat.S matita_arithmetics_nat.O)))
                               (matita_arithmetics_nat.plus_n_Sm
                                  (log p (matita_arithmetics_nat.S m))
                                  matita_arithmetics_nat.O)
                               (log p (matita_arithmetics_nat.S m))
                               (matita_arithmetics_nat.plus_n_O
                                  (log p (matita_arithmetics_nat.S m)))))
                         (matita_arithmetics_div_and_mod.mod
                            (log p (matita_arithmetics_nat.S m))
                            matita_arithmetics_nat.O)
                         (matita_basics_logic.rewrite_r
                            matita_arithmetics_nat.nat
                            (matita_arithmetics_nat.plus
                               matita_arithmetics_nat.O
                               (matita_arithmetics_div_and_mod.mod
                                  (log p (matita_arithmetics_nat.S m))
                                  matita_arithmetics_nat.O))
                            (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                             matita_basics_logic.eq
                               matita_arithmetics_nat.nat
                               (log p (matita_arithmetics_nat.S m))
                               __)
                            (matita_basics_logic.rewrite_l
                               matita_arithmetics_nat.nat
                               (matita_arithmetics_nat.plus
                                  (matita_arithmetics_div_and_mod.mod
                                     (log p (matita_arithmetics_nat.S m))
                                     matita_arithmetics_nat.O)
                                  matita_arithmetics_nat.O)
                               (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                                matita_basics_logic.eq
                                  matita_arithmetics_nat.nat
                                  (log p (matita_arithmetics_nat.S m))
                                  __)
                               (matita_basics_logic.rewrite_r
                                  matita_arithmetics_nat.nat
                                  (matita_arithmetics_nat.times
                                     matita_arithmetics_nat.O
                                     (matita_arithmetics_div_and_mod.div
                                        (log p (matita_arithmetics_nat.S m))
                                        matita_arithmetics_nat.O))
                                  (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                                   matita_basics_logic.eq
                                     matita_arithmetics_nat.nat
                                     (log p (matita_arithmetics_nat.S m))
                                     (matita_arithmetics_nat.plus
                                        (matita_arithmetics_div_and_mod.mod
                                           (log p (matita_arithmetics_nat.S m))
                                           matita_arithmetics_nat.O)
                                        __))
                                  (matita_basics_logic.rewrite_l
                                     matita_arithmetics_nat.nat
                                     (matita_arithmetics_nat.plus
                                        (matita_arithmetics_nat.times
                                           matita_arithmetics_nat.O
                                           (matita_arithmetics_div_and_mod.div
                                              (log p (matita_arithmetics_nat.S m))
                                              matita_arithmetics_nat.O))
                                        (matita_arithmetics_div_and_mod.mod
                                           (log p (matita_arithmetics_nat.S m))
                                           matita_arithmetics_nat.O))
                                     (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                                      matita_basics_logic.eq
                                        matita_arithmetics_nat.nat
                                        (log p (matita_arithmetics_nat.S m))
                                        __)
                                     (let_clause_1033
                                        p
                                        n
                                        lt1p
                                        m
                                        (log p (matita_arithmetics_nat.S m))
                                        matita_arithmetics_nat.O)
                                     (matita_arithmetics_nat.plus
                                        (matita_arithmetics_div_and_mod.mod
                                           (log p (matita_arithmetics_nat.S m))
                                           matita_arithmetics_nat.O)
                                        (matita_arithmetics_nat.times
                                           matita_arithmetics_nat.O
                                           (matita_arithmetics_div_and_mod.div
                                              (log p (matita_arithmetics_nat.S m))
                                              matita_arithmetics_nat.O)))
                                     (matita_arithmetics_nat.commutative_plus
                                        (matita_arithmetics_nat.times
                                           matita_arithmetics_nat.O
                                           (matita_arithmetics_div_and_mod.div
                                              (log p (matita_arithmetics_nat.S m))
                                              matita_arithmetics_nat.O))
                                        (matita_arithmetics_div_and_mod.mod
                                           (log p (matita_arithmetics_nat.S m))
                                           matita_arithmetics_nat.O)))
                                  matita_arithmetics_nat.O
                                  (matita_arithmetics_nat.times_O_n
                                     (matita_arithmetics_div_and_mod.div
                                        (log p (matita_arithmetics_nat.S m))
                                        matita_arithmetics_nat.O)))
                               (matita_arithmetics_nat.plus
                                  matita_arithmetics_nat.O
                                  (matita_arithmetics_div_and_mod.mod
                                     (log p (matita_arithmetics_nat.S m))
                                     matita_arithmetics_nat.O))
                               (matita_arithmetics_nat.commutative_plus
                                  (matita_arithmetics_div_and_mod.mod
                                     (log p (matita_arithmetics_nat.S m))
                                     matita_arithmetics_nat.O)
                                  matita_arithmetics_nat.O))
                            (matita_arithmetics_div_and_mod.mod
                               (log p (matita_arithmetics_nat.S m))
                               matita_arithmetics_nat.O)
                            (matita_arithmetics_nat.plus_O_n
                               (matita_arithmetics_div_and_mod.mod
                                  (log p (matita_arithmetics_nat.S m))
                                  matita_arithmetics_nat.O))))
                      (matita_arithmetics_nat.plus
                         (matita_arithmetics_div_and_mod.mod
                            (log p (matita_arithmetics_nat.S m))
                            matita_arithmetics_nat.O)
                         (matita_arithmetics_nat.times
                            matita_arithmetics_nat.O
                            (matita_arithmetics_div_and_mod.div
                               (log p (matita_arithmetics_nat.S m))
                               matita_arithmetics_nat.O)))
                      (matita_basics_logic.rewrite_l
                         matita_arithmetics_nat.nat
                         (matita_arithmetics_nat.plus
                            (matita_arithmetics_nat.times
                               matita_arithmetics_nat.O
                               (matita_arithmetics_div_and_mod.div
                                  (log p (matita_arithmetics_nat.S m))
                                  matita_arithmetics_nat.O))
                            (matita_arithmetics_div_and_mod.mod
                               (log p (matita_arithmetics_nat.S m))
                               matita_arithmetics_nat.O))
                         (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                          matita_basics_logic.eq
                            matita_arithmetics_nat.nat
                            (log p (matita_arithmetics_nat.S m))
                            __)
                         (let_clause_1033
                            p
                            n
                            lt1p
                            m
                            (log p (matita_arithmetics_nat.S m))
                            matita_arithmetics_nat.O)
                         (matita_arithmetics_nat.plus
                            (matita_arithmetics_div_and_mod.mod
                               (log p (matita_arithmetics_nat.S m))
                               matita_arithmetics_nat.O)
                            (matita_arithmetics_nat.times
                               matita_arithmetics_nat.O
                               (matita_arithmetics_div_and_mod.div
                                  (log p (matita_arithmetics_nat.S m))
                                  matita_arithmetics_nat.O)))
                         (matita_arithmetics_nat.commutative_plus
                            (matita_arithmetics_nat.times
                               matita_arithmetics_nat.O
                               (matita_arithmetics_div_and_mod.div
                                  (log p (matita_arithmetics_nat.S m))
                                  matita_arithmetics_nat.O))
                            (matita_arithmetics_div_and_mod.mod
                               (log p (matita_arithmetics_nat.S m))
                               matita_arithmetics_nat.O)))))
                (matita_arithmetics_minimization.max
                   (matita_arithmetics_nat.S (matita_arithmetics_nat.S m))
                   (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                    matita_arithmetics_nat.leb
                      (matita_arithmetics_exp.exp p x)
                      (matita_arithmetics_nat.S m)))
                (tech_log p (matita_arithmetics_nat.S m) lt1p (matita_arithmetics_nat.lt_O_S m))))))
    n.

def log_times1 :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  m:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) ->
  __1:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O n)) ->
  __2:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O m)) ->
  pts.El
    pts.var
    (matita_arithmetics_nat.le
       (log p (matita_arithmetics_nat.times n m))
       (matita_arithmetics_nat.S (matita_arithmetics_nat.plus (log p n) (log p m))))
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  m:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1p:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) =>
  posn:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O n)) =>
  posm:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O m)) =>
  matita_arithmetics_minimization.f_false_to_le_max
    (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
     matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) (matita_arithmetics_nat.times n m))
    (matita_arithmetics_nat.times n m)
    (matita_arithmetics_nat.S (matita_arithmetics_nat.plus (log p n) (log p m)))
    (matita_basics_logic.ex_intro
       matita_arithmetics_nat.nat
       (i:(pts.El pts.var matita_arithmetics_nat.nat) =>
        matita_basics_logic.And
          (matita_arithmetics_nat.lt i (matita_arithmetics_nat.times n m))
          (matita_basics_logic.eq
             matita_basics_bool.bool
             (matita_arithmetics_nat.leb
                (matita_arithmetics_exp.exp p i)
                (matita_arithmetics_nat.times n m))
             matita_basics_bool.true))
       matita_arithmetics_nat.O
       (matita_basics_logic.conj
          (matita_arithmetics_nat.lt matita_arithmetics_nat.O (matita_arithmetics_nat.times n m))
          (matita_basics_logic.eq
             matita_basics_bool.bool
             (matita_arithmetics_nat.leb
                (matita_arithmetics_exp.exp p matita_arithmetics_nat.O)
                (matita_arithmetics_nat.times n m))
             matita_basics_bool.true)
          (matita_basics_logic.eq_ind_r
             matita_arithmetics_nat.nat
             (matita_arithmetics_nat.times matita_arithmetics_nat.O matita_arithmetics_nat.O)
             (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
              __:(pts.El
                    pts.var
                    (matita_basics_logic.eq
                       matita_arithmetics_nat.nat
                       x
                       (matita_arithmetics_nat.times
                          matita_arithmetics_nat.O
                          matita_arithmetics_nat.O))) =>
              matita_arithmetics_nat.lt x (matita_arithmetics_nat.times n m))
             (matita_arithmetics_nat.lt_times
                matita_arithmetics_nat.O
                n
                matita_arithmetics_nat.O
                m
                posn
                posm)
             matita_arithmetics_nat.O
             (matita_arithmetics_nat.times_n_O matita_arithmetics_nat.O))
          (matita_arithmetics_nat.le_to_leb_true
             (matita_arithmetics_exp.exp p matita_arithmetics_nat.O)
             (matita_arithmetics_nat.times n m)
             (matita_basics_logic.eq_ind_r
                matita_arithmetics_nat.nat
                (matita_arithmetics_nat.times matita_arithmetics_nat.O matita_arithmetics_nat.O)
                (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                 __:(pts.El
                       pts.var
                       (matita_basics_logic.eq
                          matita_arithmetics_nat.nat
                          x
                          (matita_arithmetics_nat.times
                             matita_arithmetics_nat.O
                             matita_arithmetics_nat.O))) =>
                 matita_arithmetics_nat.le
                   (matita_arithmetics_nat.S x)
                   (matita_arithmetics_nat.times n m))
                (matita_arithmetics_nat.lt_times
                   matita_arithmetics_nat.O
                   n
                   matita_arithmetics_nat.O
                   m
                   posn
                   posm)
                matita_arithmetics_nat.O
                (matita_arithmetics_nat.times_n_O matita_arithmetics_nat.O)))))
    (i:(pts.El pts.var matita_arithmetics_nat.nat) =>
     Hm:(pts.El
           pts.var
           (matita_arithmetics_nat.lt
              (matita_arithmetics_nat.S (matita_arithmetics_nat.plus (log p n) (log p m)))
              i)) =>
     matita_arithmetics_nat.lt_to_leb_false
       (matita_arithmetics_exp.exp p i)
       (matita_arithmetics_nat.times n m)
       (matita_arithmetics_nat.lt_to_le_to_lt
          (matita_arithmetics_nat.times n m)
          (matita_arithmetics_nat.times
             (matita_arithmetics_exp.exp p (matita_arithmetics_nat.S (log p n)))
             (matita_arithmetics_exp.exp p (matita_arithmetics_nat.S (log p m))))
          (matita_arithmetics_exp.exp p i)
          (matita_arithmetics_nat.lt_times
             n
             (matita_arithmetics_exp.exp p (matita_arithmetics_nat.S (log p n)))
             m
             (matita_arithmetics_exp.exp p (matita_arithmetics_nat.S (log p m)))
             (lt_exp_log p n lt1p)
             (lt_exp_log p m lt1p))
          (matita_basics_logic.eq_ind
             matita_arithmetics_nat.nat
             (matita_arithmetics_exp.exp
                p
                (matita_arithmetics_nat.plus
                   (matita_arithmetics_nat.S (log p n))
                   (matita_arithmetics_nat.S (log p m))))
             (x_1:(pts.El pts.var matita_arithmetics_nat.nat) =>
              _x_2:(pts.El
                      pts.var
                      (matita_basics_logic.eq
                         matita_arithmetics_nat.nat
                         (matita_arithmetics_exp.exp
                            p
                            (matita_arithmetics_nat.plus
                               (matita_arithmetics_nat.S (log p n))
                               (matita_arithmetics_nat.S (log p m))))
                         x_1)) =>
              matita_arithmetics_nat.le x_1 (matita_arithmetics_exp.exp p i))
             (matita_arithmetics_exp.le_exp
                (matita_arithmetics_nat.plus
                   (matita_arithmetics_nat.S (log p n))
                   (matita_arithmetics_nat.S (log p m)))
                i
                p
                (matita_arithmetics_nat.lt_to_le
                   (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                   p
                   lt1p)
                (matita_basics_logic.eq_ind
                   matita_arithmetics_nat.nat
                   (matita_arithmetics_nat.S
                      (matita_arithmetics_nat.plus
                         (matita_arithmetics_minimization.max'
                            n
                            (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                             matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) n)
                            matita_arithmetics_nat.O)
                         (matita_arithmetics_minimization.max'
                            m
                            (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                             matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) m)
                            matita_arithmetics_nat.O)))
                   (x_1:(pts.El pts.var matita_arithmetics_nat.nat) =>
                    _x_2:(pts.El
                            pts.var
                            (matita_basics_logic.eq
                               matita_arithmetics_nat.nat
                               (matita_arithmetics_nat.S
                                  (matita_arithmetics_nat.plus
                                     (matita_arithmetics_minimization.max'
                                        n
                                        (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                                         matita_arithmetics_nat.leb
                                           (matita_arithmetics_exp.exp p x)
                                           n)
                                        matita_arithmetics_nat.O)
                                     (matita_arithmetics_minimization.max'
                                        m
                                        (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                                         matita_arithmetics_nat.leb
                                           (matita_arithmetics_exp.exp p x)
                                           m)
                                        matita_arithmetics_nat.O)))
                               x_1)) =>
                    matita_arithmetics_nat.le (matita_arithmetics_nat.S x_1) i)
                   Hm
                   (matita_arithmetics_nat.plus
                      (matita_arithmetics_minimization.max'
                         n
                         (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                          matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) n)
                         matita_arithmetics_nat.O)
                      (matita_arithmetics_nat.S
                         (matita_arithmetics_minimization.max'
                            m
                            (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                             matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) m)
                            matita_arithmetics_nat.O)))
                   (matita_arithmetics_nat.plus_n_Sm
                      (matita_arithmetics_minimization.max'
                         n
                         (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                          matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) n)
                         matita_arithmetics_nat.O)
                      (matita_arithmetics_minimization.max'
                         m
                         (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                          matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) m)
                         matita_arithmetics_nat.O))))
             (matita_arithmetics_nat.times
                (matita_arithmetics_exp.exp p (matita_arithmetics_nat.S (log p n)))
                (matita_arithmetics_exp.exp p (matita_arithmetics_nat.S (log p m))))
             (matita_arithmetics_exp.exp_plus_times
                p
                (matita_arithmetics_nat.S (log p n))
                (matita_arithmetics_nat.S (log p m)))))).

def log_times :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  m:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) ->
  pts.El
    pts.var
    (matita_arithmetics_nat.le
       (log p (matita_arithmetics_nat.times n m))
       (matita_arithmetics_nat.S (matita_arithmetics_nat.plus (log p n) (log p m))))
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  m:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1p:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) =>
  matita_arithmetics_nat.match_nat
    pts.var
    (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
     matita_arithmetics_nat.le
       (log p (matita_arithmetics_nat.times __ m))
       (matita_arithmetics_nat.S (matita_arithmetics_nat.plus (log p __) (log p m))))
    (matita_basics_logic.eq_coerc
       (matita_arithmetics_nat.le
          (matita_arithmetics_nat.minus
             (matita_arithmetics_nat.plus
                (log p matita_arithmetics_nat.O)
                (matita_arithmetics_nat.S (log p m)))
             (matita_arithmetics_nat.S (log p m)))
          (matita_arithmetics_nat.plus
             (log p matita_arithmetics_nat.O)
             (matita_arithmetics_nat.S (log p m))))
       (matita_arithmetics_nat.le
          (log p (matita_arithmetics_nat.times matita_arithmetics_nat.O m))
          (matita_arithmetics_nat.S
             (matita_arithmetics_nat.plus (log p matita_arithmetics_nat.O) (log p m))))
       (matita_arithmetics_nat.minus_le
          (matita_arithmetics_nat.plus
             (log p matita_arithmetics_nat.O)
             (matita_arithmetics_nat.S (log p m)))
          (matita_arithmetics_nat.S (log p m)))
       (matita_basics_logic.rewrite_l
          matita_arithmetics_nat.nat
          (log p matita_arithmetics_nat.O)
          (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
           matita_basics_logic.eq
             (pts.u pts.var)
             (matita_arithmetics_nat.le
                __
                (matita_arithmetics_nat.plus
                   (log p matita_arithmetics_nat.O)
                   (matita_arithmetics_nat.S (log p m))))
             (matita_arithmetics_nat.le
                (log p (matita_arithmetics_nat.times matita_arithmetics_nat.O m))
                (matita_arithmetics_nat.S
                   (matita_arithmetics_nat.plus (log p matita_arithmetics_nat.O) (log p m)))))
          (matita_basics_logic.rewrite_r
             matita_arithmetics_nat.nat
             (matita_arithmetics_nat.times m matita_arithmetics_nat.O)
             (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
              matita_basics_logic.eq
                (pts.u pts.var)
                (matita_arithmetics_nat.le
                   (log p matita_arithmetics_nat.O)
                   (matita_arithmetics_nat.plus
                      (log p matita_arithmetics_nat.O)
                      (matita_arithmetics_nat.S (log p m))))
                (matita_arithmetics_nat.le
                   (log p __)
                   (matita_arithmetics_nat.S
                      (matita_arithmetics_nat.plus (log p matita_arithmetics_nat.O) (log p m)))))
             (matita_basics_logic.rewrite_l
                matita_arithmetics_nat.nat
                matita_arithmetics_nat.O
                (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                 matita_basics_logic.eq
                   (pts.u pts.var)
                   (matita_arithmetics_nat.le
                      (log p matita_arithmetics_nat.O)
                      (matita_arithmetics_nat.plus
                         (log p matita_arithmetics_nat.O)
                         (matita_arithmetics_nat.S (log p m))))
                   (matita_arithmetics_nat.le
                      (log p __)
                      (matita_arithmetics_nat.S
                         (matita_arithmetics_nat.plus
                            (log p matita_arithmetics_nat.O)
                            (log p m)))))
                (matita_basics_logic.rewrite_r
                   matita_arithmetics_nat.nat
                   (matita_arithmetics_nat.plus (log p m) (log p matita_arithmetics_nat.O))
                   (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                    matita_basics_logic.eq
                      (pts.u pts.var)
                      (matita_arithmetics_nat.le
                         (log p matita_arithmetics_nat.O)
                         (matita_arithmetics_nat.plus
                            (log p matita_arithmetics_nat.O)
                            (matita_arithmetics_nat.S (log p m))))
                      (matita_arithmetics_nat.le
                         (log p matita_arithmetics_nat.O)
                         (matita_arithmetics_nat.S __)))
                   (matita_basics_logic.rewrite_r
                      matita_arithmetics_nat.nat
                      (matita_arithmetics_nat.plus
                         (log p m)
                         (matita_arithmetics_nat.S (log p matita_arithmetics_nat.O)))
                      (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                       matita_basics_logic.eq
                         (pts.u pts.var)
                         (matita_arithmetics_nat.le
                            (log p matita_arithmetics_nat.O)
                            (matita_arithmetics_nat.plus
                               (log p matita_arithmetics_nat.O)
                               (matita_arithmetics_nat.S (log p m))))
                         (matita_arithmetics_nat.le (log p matita_arithmetics_nat.O) __))
                      (matita_basics_logic.rewrite_r
                         matita_arithmetics_nat.nat
                         (matita_arithmetics_nat.plus
                            (log p m)
                            (matita_arithmetics_nat.S (log p matita_arithmetics_nat.O)))
                         (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                          matita_basics_logic.eq
                            (pts.u pts.var)
                            (matita_arithmetics_nat.le (log p matita_arithmetics_nat.O) __)
                            (matita_arithmetics_nat.le
                               (log p matita_arithmetics_nat.O)
                               (matita_arithmetics_nat.plus
                                  (log p m)
                                  (matita_arithmetics_nat.S
                                     (log p matita_arithmetics_nat.O)))))
                         (matita_basics_logic.refl
                            (pts.u pts.var)
                            (matita_arithmetics_nat.le
                               (log p matita_arithmetics_nat.O)
                               (matita_arithmetics_nat.plus
                                  (log p m)
                                  (matita_arithmetics_nat.S
                                     (log p matita_arithmetics_nat.O)))))
                         (matita_arithmetics_nat.plus
                            (log p matita_arithmetics_nat.O)
                            (matita_arithmetics_nat.S (log p m)))
                         (matita_basics_logic.rewrite_l
                            matita_arithmetics_nat.nat
                            (matita_arithmetics_nat.S
                               (matita_arithmetics_nat.plus
                                  (log p matita_arithmetics_nat.O)
                                  (log p m)))
                            (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                             matita_basics_logic.eq
                               matita_arithmetics_nat.nat
                               __
                               (matita_arithmetics_nat.plus
                                  (log p m)
                                  (matita_arithmetics_nat.S
                                     (log p matita_arithmetics_nat.O))))
                            (matita_basics_logic.rewrite_l
                               matita_arithmetics_nat.nat
                               (matita_arithmetics_nat.plus
                                  (log p m)
                                  (log p matita_arithmetics_nat.O))
                               (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                                matita_basics_logic.eq
                                  matita_arithmetics_nat.nat
                                  (matita_arithmetics_nat.S __)
                                  (matita_arithmetics_nat.plus
                                     (log p m)
                                     (matita_arithmetics_nat.S
                                        (log p matita_arithmetics_nat.O))))
                               (matita_arithmetics_nat.plus_n_Sm
                                  (log p m)
                                  (log p matita_arithmetics_nat.O))
                               (matita_arithmetics_nat.plus
                                  (log p matita_arithmetics_nat.O)
                                  (log p m))
                               (matita_arithmetics_nat.commutative_plus
                                  (log p m)
                                  (log p matita_arithmetics_nat.O)))
                            (matita_arithmetics_nat.plus
                               (log p matita_arithmetics_nat.O)
                               (matita_arithmetics_nat.S (log p m)))
                            (matita_arithmetics_nat.plus_n_Sm
                               (log p matita_arithmetics_nat.O)
                               (log p m))))
                      (matita_arithmetics_nat.S
                         (matita_arithmetics_nat.plus
                            (log p m)
                            (log p matita_arithmetics_nat.O)))
                      (matita_arithmetics_nat.plus_n_Sm
                         (log p m)
                         (log p matita_arithmetics_nat.O)))
                   (matita_arithmetics_nat.plus (log p matita_arithmetics_nat.O) (log p m))
                   (matita_arithmetics_nat.commutative_plus
                      (log p matita_arithmetics_nat.O)
                      (log p m)))
                (matita_arithmetics_nat.times m matita_arithmetics_nat.O)
                (matita_arithmetics_nat.times_n_O m))
             (matita_arithmetics_nat.times matita_arithmetics_nat.O m)
             (matita_arithmetics_nat.commutative_times matita_arithmetics_nat.O m))
          (matita_arithmetics_nat.minus
             (matita_arithmetics_nat.plus
                (log p matita_arithmetics_nat.O)
                (matita_arithmetics_nat.S (log p m)))
             (matita_arithmetics_nat.S (log p m)))
          (matita_arithmetics_nat.minus_plus_m_m
             (log p matita_arithmetics_nat.O)
             (matita_arithmetics_nat.S (log p m)))))
    (n0:(pts.El pts.var matita_arithmetics_nat.nat) =>
     matita_arithmetics_nat.match_nat
       pts.var
       (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
        matita_arithmetics_nat.le
          (log p (matita_arithmetics_nat.times (matita_arithmetics_nat.S n0) __))
          (matita_arithmetics_nat.S
             (matita_arithmetics_nat.plus (log p (matita_arithmetics_nat.S n0)) (log p __))))
       (matita_basics_logic.eq_ind
          matita_arithmetics_nat.nat
          matita_arithmetics_nat.O
          (x_1:(pts.El pts.var matita_arithmetics_nat.nat) =>
           _x_2:(pts.El
                   pts.var
                   (matita_basics_logic.eq
                      matita_arithmetics_nat.nat
                      matita_arithmetics_nat.O
                      x_1)) =>
           matita_arithmetics_nat.le
             (log p x_1)
             (matita_arithmetics_nat.S
                (matita_arithmetics_nat.plus
                   (log p (matita_arithmetics_nat.S n0))
                   (log p matita_arithmetics_nat.O))))
          (matita_arithmetics_nat.le_O_n
             (matita_arithmetics_nat.S
                (matita_arithmetics_nat.plus
                   (log p (matita_arithmetics_nat.S n0))
                   (log p matita_arithmetics_nat.O))))
          (matita_arithmetics_nat.times (matita_arithmetics_nat.S n0) matita_arithmetics_nat.O)
          (matita_arithmetics_nat.times_n_O (matita_arithmetics_nat.S n0)))
       (m0:(pts.El pts.var matita_arithmetics_nat.nat) =>
        log_times1
          p
          (matita_arithmetics_nat.S n0)
          (matita_arithmetics_nat.S m0)
          lt1p
          (matita_arithmetics_nat.lt_O_S n0)
          (matita_arithmetics_nat.lt_O_S m0))
       m)
    n.

def log_times_l :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  m:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O n)) ->
  __1:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O m)) ->
  __2:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) ->
  pts.El
    pts.var
    (matita_arithmetics_nat.le
       (matita_arithmetics_nat.plus (log p n) (log p m))
       (log p (matita_arithmetics_nat.times n m)))
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  m:(pts.El pts.var matita_arithmetics_nat.nat) =>
  posn:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O n)) =>
  posm:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O m)) =>
  lt1p:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) =>
  matita_arithmetics_minimization.true_to_le_max
    (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
     matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) (matita_arithmetics_nat.times n m))
    (matita_arithmetics_nat.times n m)
    (matita_arithmetics_nat.plus (log p n) (log p m))
    (matita_arithmetics_nat.match_le
       (matita_arithmetics_nat.S matita_arithmetics_nat.O)
       pts.var
       (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
        _0:(pts.El
              pts.var
              (matita_arithmetics_nat.le (matita_arithmetics_nat.S matita_arithmetics_nat.O) __)) =>
        matita_arithmetics_nat.lt
          (matita_arithmetics_nat.plus (log p __) (log p m))
          (matita_arithmetics_nat.times __ m))
       (matita_basics_logic.eq_ind_r
          matita_arithmetics_nat.nat
          matita_arithmetics_nat.O
          (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
           __:(pts.El
                 pts.var
                 (matita_basics_logic.eq matita_arithmetics_nat.nat x matita_arithmetics_nat.O)) =>
           matita_arithmetics_nat.lt
             (matita_arithmetics_nat.plus x (log p m))
             (matita_arithmetics_nat.times (matita_arithmetics_nat.S matita_arithmetics_nat.O) m))
          (matita_basics_logic.eq_ind_r
             matita_arithmetics_nat.nat
             (matita_arithmetics_nat.times m (matita_arithmetics_nat.S matita_arithmetics_nat.O))
             (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
              __:(pts.El
                    pts.var
                    (matita_basics_logic.eq
                       matita_arithmetics_nat.nat
                       x
                       (matita_arithmetics_nat.times
                          m
                          (matita_arithmetics_nat.S matita_arithmetics_nat.O)))) =>
              matita_arithmetics_nat.lt
                (matita_arithmetics_nat.plus matita_arithmetics_nat.O (log p m))
                x)
             (matita_basics_logic.eq_ind
                matita_arithmetics_nat.nat
                m
                (x_1:(pts.El pts.var matita_arithmetics_nat.nat) =>
                 _x_2:(pts.El
                         pts.var
                         (matita_basics_logic.eq matita_arithmetics_nat.nat m x_1)) =>
                 matita_arithmetics_nat.lt
                   (matita_arithmetics_nat.plus matita_arithmetics_nat.O (log p m))
                   x_1)
                (lt_log_n_n p m lt1p posm)
                (matita_arithmetics_nat.times
                   m
                   (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                (matita_arithmetics_nat.times_n_1 m))
             (matita_arithmetics_nat.times (matita_arithmetics_nat.S matita_arithmetics_nat.O) m)
             (matita_arithmetics_nat.commutative_times
                (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                m))
          (log p (matita_arithmetics_nat.S matita_arithmetics_nat.O))
          (log_SO p lt1p))
       (n0:(pts.El pts.var matita_arithmetics_nat.nat) =>
        posn0:(pts.El
                 pts.var
                 (matita_arithmetics_nat.le
                    (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                    n0)) =>
        matita_arithmetics_nat.match_le
          (matita_arithmetics_nat.S matita_arithmetics_nat.O)
          pts.var
          (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
           _0:(pts.El
                 pts.var
                 (matita_arithmetics_nat.le
                    (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                    __)) =>
           matita_arithmetics_nat.lt
             (matita_arithmetics_nat.plus (log p (matita_arithmetics_nat.S n0)) (log p __))
             (matita_arithmetics_nat.times (matita_arithmetics_nat.S n0) __))
          (matita_basics_logic.eq_ind_r
             matita_arithmetics_nat.nat
             matita_arithmetics_nat.O
             (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
              __:(pts.El
                    pts.var
                    (matita_basics_logic.eq
                       matita_arithmetics_nat.nat
                       x
                       matita_arithmetics_nat.O)) =>
              matita_arithmetics_nat.lt
                (matita_arithmetics_nat.plus (log p (matita_arithmetics_nat.S n0)) x)
                (matita_arithmetics_nat.times
                   (matita_arithmetics_nat.S n0)
                   (matita_arithmetics_nat.S matita_arithmetics_nat.O)))
             (matita_basics_logic.eq_ind
                matita_arithmetics_nat.nat
                (log p (matita_arithmetics_nat.S n0))
                (x_1:(pts.El pts.var matita_arithmetics_nat.nat) =>
                 _x_2:(pts.El
                         pts.var
                         (matita_basics_logic.eq
                            matita_arithmetics_nat.nat
                            (log p (matita_arithmetics_nat.S n0))
                            x_1)) =>
                 matita_arithmetics_nat.lt
                   x_1
                   (matita_arithmetics_nat.times
                      (matita_arithmetics_nat.S n0)
                      (matita_arithmetics_nat.S matita_arithmetics_nat.O)))
                (matita_basics_logic.eq_ind
                   matita_arithmetics_nat.nat
                   (matita_arithmetics_nat.S n0)
                   (x_1:(pts.El pts.var matita_arithmetics_nat.nat) =>
                    _x_2:(pts.El
                            pts.var
                            (matita_basics_logic.eq
                               matita_arithmetics_nat.nat
                               (matita_arithmetics_nat.S n0)
                               x_1)) =>
                    matita_arithmetics_nat.lt (log p (matita_arithmetics_nat.S n0)) x_1)
                   (lt_log_n_n
                      p
                      (matita_arithmetics_nat.S n0)
                      lt1p
                      (matita_arithmetics_nat.lt_O_S n0))
                   (matita_arithmetics_nat.times
                      (matita_arithmetics_nat.S n0)
                      (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                   (matita_arithmetics_nat.times_n_1 (matita_arithmetics_nat.S n0)))
                (matita_arithmetics_nat.plus
                   (log p (matita_arithmetics_nat.S n0))
                   matita_arithmetics_nat.O)
                (matita_arithmetics_nat.plus_n_O (log p (matita_arithmetics_nat.S n0))))
             (log p (matita_arithmetics_nat.S matita_arithmetics_nat.O))
             (log_SO p lt1p))
          (m1:(pts.El pts.var matita_arithmetics_nat.nat) =>
           lem1:(pts.El
                   pts.var
                   (matita_arithmetics_nat.le
                      (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                      m1)) =>
           matita_arithmetics_nat.transitive_le
             (matita_arithmetics_nat.S
                (matita_arithmetics_nat.plus
                   (log p (matita_arithmetics_nat.S n0))
                   (log p (matita_arithmetics_nat.S m1))))
             (matita_arithmetics_nat.plus
                (matita_arithmetics_nat.S n0)
                (matita_arithmetics_nat.S m1))
             (matita_arithmetics_nat.times
                (matita_arithmetics_nat.S n0)
                (matita_arithmetics_nat.S m1))
             (matita_arithmetics_nat.le_S_S
                (matita_arithmetics_nat.plus
                   (log p (matita_arithmetics_nat.S n0))
                   (log p (matita_arithmetics_nat.S m1)))
                (matita_arithmetics_nat.plus n0 (matita_arithmetics_nat.S m1))
                (matita_arithmetics_nat.le_plus
                   (log p (matita_arithmetics_nat.S n0))
                   n0
                   (log p (matita_arithmetics_nat.S m1))
                   (matita_arithmetics_nat.S m1)
                   (matita_arithmetics_nat.le_S_S_to_le
                      (log p (matita_arithmetics_nat.S n0))
                      n0
                      (lt_log_n_n
                         p
                         (matita_arithmetics_nat.S n0)
                         lt1p
                         (matita_arithmetics_nat.lt_O_S n0)))
                   (matita_arithmetics_minimization.le_max_n
                      (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                       matita_arithmetics_nat.leb
                         (matita_arithmetics_exp.exp p x)
                         (matita_arithmetics_nat.S m1))
                      (matita_arithmetics_nat.S m1))))
             (matita_arithmetics_nat.le_S_S
                (matita_arithmetics_nat.plus n0 (matita_arithmetics_nat.S m1))
                (matita_arithmetics_nat.plus
                   m1
                   (matita_arithmetics_nat.times n0 (matita_arithmetics_nat.S m1)))
                (matita_basics_logic.eq_ind_r
                   matita_arithmetics_nat.nat
                   (matita_arithmetics_nat.plus (matita_arithmetics_nat.S m1) n0)
                   (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                    __:(pts.El
                          pts.var
                          (matita_basics_logic.eq
                             matita_arithmetics_nat.nat
                             x
                             (matita_arithmetics_nat.plus (matita_arithmetics_nat.S m1) n0))) =>
                    matita_arithmetics_nat.le
                      x
                      (matita_arithmetics_nat.plus
                         m1
                         (matita_arithmetics_nat.times n0 (matita_arithmetics_nat.S m1))))
                   (matita_basics_logic.eq_ind_r
                      matita_arithmetics_nat.nat
                      (matita_arithmetics_nat.plus m1 (matita_arithmetics_nat.S n0))
                      (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                       __:(pts.El
                             pts.var
                             (matita_basics_logic.eq
                                matita_arithmetics_nat.nat
                                x
                                (matita_arithmetics_nat.plus
                                   m1
                                   (matita_arithmetics_nat.S n0)))) =>
                       matita_arithmetics_nat.le
                         x
                         (matita_arithmetics_nat.plus
                            m1
                            (matita_arithmetics_nat.times n0 (matita_arithmetics_nat.S m1))))
                      (matita_arithmetics_nat.monotonic_le_plus_r
                         m1
                         (matita_arithmetics_nat.S n0)
                         (matita_arithmetics_nat.times n0 (matita_arithmetics_nat.S m1))
                         (matita_basics_logic.eq_ind_r
                            matita_arithmetics_nat.nat
                            (matita_arithmetics_nat.times
                               n0
                               (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                            (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                             __:(pts.El
                                   pts.var
                                   (matita_basics_logic.eq
                                      matita_arithmetics_nat.nat
                                      x
                                      (matita_arithmetics_nat.times
                                         n0
                                         (matita_arithmetics_nat.S
                                            matita_arithmetics_nat.O)))) =>
                             matita_arithmetics_nat.le
                               (matita_arithmetics_nat.S x)
                               (matita_arithmetics_nat.times
                                  n0
                                  (matita_arithmetics_nat.S m1)))
                            (matita_arithmetics_nat.monotonic_lt_times_r
                               n0
                               posn0
                               (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                               (matita_arithmetics_nat.S m1)
                               (matita_arithmetics_nat.le_S_S
                                  (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                                  m1
                                  lem1))
                            n0
                            (matita_arithmetics_nat.times_n_1 n0)))
                      (matita_arithmetics_nat.S (matita_arithmetics_nat.plus m1 n0))
                      (matita_arithmetics_nat.plus_n_Sm m1 n0))
                   (matita_arithmetics_nat.plus n0 (matita_arithmetics_nat.S m1))
                   (matita_arithmetics_nat.commutative_plus n0 (matita_arithmetics_nat.S m1)))))
          m
          posm)
       n
       posn)
    (matita_arithmetics_nat.le_to_leb_true
       (matita_arithmetics_exp.exp p (matita_arithmetics_nat.plus (log p n) (log p m)))
       (matita_arithmetics_nat.times n m)
       (matita_basics_logic.eq_ind_r
          matita_arithmetics_nat.nat
          (matita_arithmetics_nat.times
             (matita_arithmetics_exp.exp p (log p n))
             (matita_arithmetics_exp.exp p (log p m)))
          (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
           __:(pts.El
                 pts.var
                 (matita_basics_logic.eq
                    matita_arithmetics_nat.nat
                    x
                    (matita_arithmetics_nat.times
                       (matita_arithmetics_exp.exp p (log p n))
                       (matita_arithmetics_exp.exp p (log p m))))) =>
           matita_arithmetics_nat.le x (matita_arithmetics_nat.times n m))
          (matita_arithmetics_nat.le_times
             (matita_arithmetics_exp.exp p (log p n))
             n
             (matita_arithmetics_exp.exp p (log p m))
             m
             (le_exp_log p n posn)
             (le_exp_log p m posm))
          (matita_arithmetics_exp.exp p (matita_arithmetics_nat.plus (log p n) (log p m)))
          (matita_arithmetics_exp.exp_plus_times p (log p n) (log p m)))).

def log_exp :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  m:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) ->
  __1:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O m)) ->
  pts.El
    pts.var
    (matita_basics_logic.eq
       matita_arithmetics_nat.nat
       (log p (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p n) m))
       (matita_arithmetics_nat.plus n (log p m)))
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  m:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1p:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) =>
  posm:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O m)) =>
  matita_arithmetics_minimization.max_spec_to_max
    (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
     matita_arithmetics_nat.leb
       (matita_arithmetics_exp.exp p x)
       (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p n) m))
    (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p n) m)
    (matita_arithmetics_nat.plus n (log p m))
    (matita_arithmetics_minimization.found_max_spec
       (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p n) m)
       (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
        matita_arithmetics_nat.leb
          (matita_arithmetics_exp.exp p x)
          (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p n) m))
       (matita_arithmetics_nat.plus n (log p m))
       (matita_arithmetics_nat.nat_ind
          (_x_365:(pts.El pts.var matita_arithmetics_nat.nat) =>
           matita_arithmetics_nat.lt
             (matita_arithmetics_nat.plus _x_365 (log p m))
             (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p _x_365) m))
          (matita_basics_logic.eq_ind
             matita_arithmetics_nat.nat
             (matita_arithmetics_nat.S matita_arithmetics_nat.O)
             (x_1:(pts.El pts.var matita_arithmetics_nat.nat) =>
              _x_2:(pts.El
                      pts.var
                      (matita_basics_logic.eq
                         matita_arithmetics_nat.nat
                         (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                         x_1)) =>
              matita_arithmetics_nat.lt
                (matita_arithmetics_nat.plus matita_arithmetics_nat.O (log p m))
                (matita_arithmetics_nat.times x_1 m))
             (matita_basics_logic.eq_ind_r
                matita_arithmetics_nat.nat
                (matita_arithmetics_nat.times
                   m
                   (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                 __:(pts.El
                       pts.var
                       (matita_basics_logic.eq
                          matita_arithmetics_nat.nat
                          x
                          (matita_arithmetics_nat.times
                             m
                             (matita_arithmetics_nat.S matita_arithmetics_nat.O)))) =>
                 matita_arithmetics_nat.lt
                   (matita_arithmetics_nat.plus matita_arithmetics_nat.O (log p m))
                   x)
                (matita_basics_logic.eq_ind
                   matita_arithmetics_nat.nat
                   m
                   (x_1:(pts.El pts.var matita_arithmetics_nat.nat) =>
                    _x_2:(pts.El
                            pts.var
                            (matita_basics_logic.eq matita_arithmetics_nat.nat m x_1)) =>
                    matita_arithmetics_nat.lt
                      (matita_arithmetics_nat.plus matita_arithmetics_nat.O (log p m))
                      x_1)
                   (lt_log_n_n p m lt1p posm)
                   (matita_arithmetics_nat.times
                      m
                      (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                   (matita_arithmetics_nat.times_n_1 m))
                (matita_arithmetics_nat.times
                   (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                   m)
                (matita_arithmetics_nat.commutative_times
                   (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                   m))
             (matita_arithmetics_exp.exp p matita_arithmetics_nat.O)
             (matita_arithmetics_exp.exp_n_O p))
          (a:(pts.El pts.var matita_arithmetics_nat.nat) =>
           Hind:(pts.El
                   pts.var
                   (matita_arithmetics_nat.lt
                      (matita_arithmetics_nat.plus a (log p m))
                      (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p a) m))) =>
           matita_arithmetics_nat.lt_to_le_to_lt
             (matita_arithmetics_nat.S (matita_arithmetics_nat.plus a (log p m)))
             (matita_arithmetics_nat.S
                (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p a) m))
             (matita_arithmetics_nat.times
                (matita_arithmetics_exp.exp p (matita_arithmetics_nat.S a))
                m)
             (matita_arithmetics_nat.le_S_S
                (matita_arithmetics_nat.S (matita_arithmetics_nat.plus a (log p m)))
                (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p a) m)
                Hind)
             (matita_basics_logic.eq_ind_r
                matita_arithmetics_nat.nat
                (matita_arithmetics_nat.times p (matita_arithmetics_exp.exp p a))
                (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                 __:(pts.El
                       pts.var
                       (matita_basics_logic.eq
                          matita_arithmetics_nat.nat
                          x
                          (matita_arithmetics_nat.times p (matita_arithmetics_exp.exp p a)))) =>
                 matita_arithmetics_nat.le
                   (matita_arithmetics_nat.S
                      (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p a) m))
                   (matita_arithmetics_nat.times x m))
                (matita_basics_logic.eq_ind_r
                   matita_arithmetics_nat.nat
                   (matita_arithmetics_nat.times
                      p
                      (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p a) m))
                   (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                    __:(pts.El
                          pts.var
                          (matita_basics_logic.eq
                             matita_arithmetics_nat.nat
                             x
                             (matita_arithmetics_nat.times
                                p
                                (matita_arithmetics_nat.times
                                   (matita_arithmetics_exp.exp p a)
                                   m)))) =>
                    matita_arithmetics_nat.le
                      (matita_arithmetics_nat.S
                         (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p a) m))
                      x)
                   (matita_basics_logic.eq_ind_r
                      matita_arithmetics_nat.nat
                      (matita_arithmetics_nat.times
                         (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p a) m)
                         (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                      (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                       __:(pts.El
                             pts.var
                             (matita_basics_logic.eq
                                matita_arithmetics_nat.nat
                                x
                                (matita_arithmetics_nat.times
                                   (matita_arithmetics_nat.times
                                      (matita_arithmetics_exp.exp p a)
                                      m)
                                   (matita_arithmetics_nat.S matita_arithmetics_nat.O)))) =>
                       matita_arithmetics_nat.le
                         (matita_arithmetics_nat.S x)
                         (matita_arithmetics_nat.times
                            p
                            (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p a) m)))
                      (matita_basics_logic.eq_ind_r
                         matita_arithmetics_nat.nat
                         (matita_arithmetics_nat.times
                            (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                            (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p a) m))
                         (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                          __:(pts.El
                                pts.var
                                (matita_basics_logic.eq
                                   matita_arithmetics_nat.nat
                                   x
                                   (matita_arithmetics_nat.times
                                      (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                                      (matita_arithmetics_nat.times
                                         (matita_arithmetics_exp.exp p a)
                                         m)))) =>
                          matita_arithmetics_nat.le
                            (matita_arithmetics_nat.S x)
                            (matita_arithmetics_nat.times
                               p
                               (matita_arithmetics_nat.times
                                  (matita_arithmetics_exp.exp p a)
                                  m)))
                         (matita_arithmetics_nat.monotonic_lt_times_l
                            (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p a) m)
                            (matita_basics_logic.eq_ind_r
                               matita_arithmetics_nat.nat
                               (matita_arithmetics_nat.times
                                  matita_arithmetics_nat.O
                                  matita_arithmetics_nat.O)
                               (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                                __:(pts.El
                                      pts.var
                                      (matita_basics_logic.eq
                                         matita_arithmetics_nat.nat
                                         x
                                         (matita_arithmetics_nat.times
                                            matita_arithmetics_nat.O
                                            matita_arithmetics_nat.O))) =>
                                matita_arithmetics_nat.lt
                                  x
                                  (matita_arithmetics_nat.times
                                     (matita_arithmetics_exp.exp p a)
                                     m))
                               (matita_arithmetics_nat.lt_times
                                  matita_arithmetics_nat.O
                                  (matita_arithmetics_exp.exp p a)
                                  matita_arithmetics_nat.O
                                  m
                                  (matita_arithmetics_exp.lt_O_exp
                                     p
                                     a
                                     (matita_arithmetics_nat.lt_to_le
                                        (matita_arithmetics_nat.S
                                           matita_arithmetics_nat.O)
                                        p
                                        lt1p))
                                  posm)
                               matita_arithmetics_nat.O
                               (matita_arithmetics_nat.times_n_O matita_arithmetics_nat.O))
                            (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                            p
                            lt1p)
                         (matita_arithmetics_nat.times
                            (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p a) m)
                            (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                         (matita_arithmetics_nat.commutative_times
                            (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p a) m)
                            (matita_arithmetics_nat.S matita_arithmetics_nat.O)))
                      (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p a) m)
                      (matita_arithmetics_nat.times_n_1
                         (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p a) m)))
                   (matita_arithmetics_nat.times
                      (matita_arithmetics_nat.times p (matita_arithmetics_exp.exp p a))
                      m)
                   (matita_arithmetics_nat.associative_times
                      p
                      (matita_arithmetics_exp.exp p a)
                      m))
                (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p a) p)
                (matita_arithmetics_nat.commutative_times (matita_arithmetics_exp.exp p a) p)))
          n)
       (matita_arithmetics_nat.le_to_leb_true
          (matita_arithmetics_exp.exp p (matita_arithmetics_nat.plus n (log p m)))
          (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p n) m)
          (matita_basics_logic.eq_ind_r
             matita_arithmetics_nat.nat
             (matita_arithmetics_nat.times
                (matita_arithmetics_exp.exp p n)
                (matita_arithmetics_exp.exp p (log p m)))
             (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
              __:(pts.El
                    pts.var
                    (matita_basics_logic.eq
                       matita_arithmetics_nat.nat
                       x
                       (matita_arithmetics_nat.times
                          (matita_arithmetics_exp.exp p n)
                          (matita_arithmetics_exp.exp p (log p m))))) =>
              matita_arithmetics_nat.le
                x
                (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p n) m))
             (matita_arithmetics_nat.monotonic_le_times_r
                (matita_arithmetics_exp.exp p n)
                (matita_arithmetics_exp.exp p (log p m))
                m
                (le_exp_log p m posm))
             (matita_arithmetics_exp.exp p (matita_arithmetics_nat.plus n (log p m)))
             (matita_arithmetics_exp.exp_plus_times p n (log p m))))
       (i:(pts.El pts.var matita_arithmetics_nat.nat) =>
        Hi:(pts.El
              pts.var
              (matita_arithmetics_nat.lt (matita_arithmetics_nat.plus n (log p m)) i)) =>
        Hm:(pts.El
              pts.var
              (matita_arithmetics_nat.lt
                 i
                 (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p n) m))) =>
        matita_arithmetics_nat.lt_to_leb_false
          (matita_arithmetics_exp.exp p i)
          (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p n) m)
          (matita_arithmetics_nat.lt_to_le_to_lt
             (matita_arithmetics_nat.times (matita_arithmetics_exp.exp p n) m)
             (matita_arithmetics_nat.times
                (matita_arithmetics_exp.exp p n)
                (matita_arithmetics_exp.exp p (matita_arithmetics_nat.S (log p m))))
             (matita_arithmetics_exp.exp p i)
             (matita_arithmetics_nat.monotonic_lt_times_r
                (matita_arithmetics_exp.exp p n)
                (matita_arithmetics_exp.lt_O_exp
                   p
                   n
                   (matita_arithmetics_nat.lt_to_le
                      (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                      p
                      lt1p))
                m
                (matita_arithmetics_exp.exp p (matita_arithmetics_nat.S (log p m)))
                (lt_exp_log p m lt1p))
             (matita_basics_logic.eq_ind
                matita_arithmetics_nat.nat
                (matita_arithmetics_exp.exp
                   p
                   (matita_arithmetics_nat.plus n (matita_arithmetics_nat.S (log p m))))
                (x_1:(pts.El pts.var matita_arithmetics_nat.nat) =>
                 _x_2:(pts.El
                         pts.var
                         (matita_basics_logic.eq
                            matita_arithmetics_nat.nat
                            (matita_arithmetics_exp.exp
                               p
                               (matita_arithmetics_nat.plus
                                  n
                                  (matita_arithmetics_nat.S (log p m))))
                            x_1)) =>
                 matita_arithmetics_nat.le x_1 (matita_arithmetics_exp.exp p i))
                (matita_arithmetics_exp.le_exp
                   (matita_arithmetics_nat.plus n (matita_arithmetics_nat.S (log p m)))
                   i
                   p
                   (matita_arithmetics_nat.lt_to_le
                      (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                      p
                      lt1p)
                   (matita_basics_logic.eq_coerc
                      (matita_arithmetics_nat.le
                         (matita_arithmetics_nat.S (matita_arithmetics_nat.plus n (log p m)))
                         i)
                      (matita_arithmetics_nat.le
                         (matita_arithmetics_nat.plus n (matita_arithmetics_nat.S (log p m)))
                         i)
                      Hi
                      (matita_basics_logic.rewrite_r
                         matita_arithmetics_nat.nat
                         (matita_arithmetics_nat.plus n (matita_arithmetics_nat.S (log p m)))
                         (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                          matita_basics_logic.eq
                            (pts.u pts.var)
                            (matita_arithmetics_nat.le __ i)
                            (matita_arithmetics_nat.le
                               (matita_arithmetics_nat.plus
                                  n
                                  (matita_arithmetics_nat.S (log p m)))
                               i))
                         (matita_basics_logic.refl
                            (pts.u pts.var)
                            (matita_arithmetics_nat.le
                               (matita_arithmetics_nat.plus
                                  n
                                  (matita_arithmetics_nat.S (log p m)))
                               i))
                         (matita_arithmetics_nat.S (matita_arithmetics_nat.plus n (log p m)))
                         (matita_arithmetics_nat.plus_n_Sm n (log p m)))))
                (matita_arithmetics_nat.times
                   (matita_arithmetics_exp.exp p n)
                   (matita_arithmetics_exp.exp p (matita_arithmetics_nat.S (log p m))))
                (matita_arithmetics_exp.exp_plus_times p n (matita_arithmetics_nat.S (log p m))))))).

def eq_log_exp :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) ->
  pts.El
    pts.var
    (matita_basics_logic.eq matita_arithmetics_nat.nat (log p (matita_arithmetics_exp.exp p n)) n)
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1p:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) =>
  matita_basics_logic.eq_ind_r
    matita_arithmetics_nat.nat
    (matita_arithmetics_nat.times
       (matita_arithmetics_exp.exp p n)
       (matita_arithmetics_nat.S matita_arithmetics_nat.O))
    (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
     __:(pts.El
           pts.var
           (matita_basics_logic.eq
              matita_arithmetics_nat.nat
              x
              (matita_arithmetics_nat.times
                 (matita_arithmetics_exp.exp p n)
                 (matita_arithmetics_nat.S matita_arithmetics_nat.O)))) =>
     matita_basics_logic.eq matita_arithmetics_nat.nat (log p x) n)
    (matita_basics_logic.eq_ind_r
       matita_arithmetics_nat.nat
       (matita_arithmetics_nat.plus n (log p (matita_arithmetics_nat.S matita_arithmetics_nat.O)))
       (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
        __:(pts.El
              pts.var
              (matita_basics_logic.eq
                 matita_arithmetics_nat.nat
                 x
                 (matita_arithmetics_nat.plus
                    n
                    (log p (matita_arithmetics_nat.S matita_arithmetics_nat.O))))) =>
        matita_basics_logic.eq matita_arithmetics_nat.nat x n)
       (matita_basics_logic.eq_ind_r
          matita_arithmetics_nat.nat
          matita_arithmetics_nat.O
          (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
           __:(pts.El
                 pts.var
                 (matita_basics_logic.eq matita_arithmetics_nat.nat x matita_arithmetics_nat.O)) =>
           matita_basics_logic.eq matita_arithmetics_nat.nat (matita_arithmetics_nat.plus n x) n)
          (matita_basics_logic.rewrite_l
             matita_arithmetics_nat.nat
             n
             (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
              matita_basics_logic.eq matita_arithmetics_nat.nat __ n)
             (matita_basics_logic.refl matita_arithmetics_nat.nat n)
             (matita_arithmetics_nat.plus n matita_arithmetics_nat.O)
             (matita_arithmetics_nat.plus_n_O n))
          (log p (matita_arithmetics_nat.S matita_arithmetics_nat.O))
          (log_SO p lt1p))
       (log
          p
          (matita_arithmetics_nat.times
             (matita_arithmetics_exp.exp p n)
             (matita_arithmetics_nat.S matita_arithmetics_nat.O)))
       (log_exp
          p
          n
          (matita_arithmetics_nat.S matita_arithmetics_nat.O)
          lt1p
          (matita_arithmetics_nat.lt_O_S matita_arithmetics_nat.O)))
    (matita_arithmetics_exp.exp p n)
    (matita_arithmetics_nat.times_n_1 (matita_arithmetics_exp.exp p n)).

def log_exp1 :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  m:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) ->
  pts.El
    pts.var
    (matita_arithmetics_nat.le
       (log p (matita_arithmetics_exp.exp n m))
       (matita_arithmetics_nat.times m (matita_arithmetics_nat.S (log p n))))
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  m:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1p:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) =>
  matita_arithmetics_nat.nat_ind
    (_x_365:(pts.El pts.var matita_arithmetics_nat.nat) =>
     matita_arithmetics_nat.le
       (log p (matita_arithmetics_exp.exp n _x_365))
       (matita_arithmetics_nat.times _x_365 (matita_arithmetics_nat.S (log p n))))
    (matita_arithmetics_nat.le_x_times_x
       (log p (matita_arithmetics_exp.exp n matita_arithmetics_nat.O)))
    (m0:(pts.El pts.var matita_arithmetics_nat.nat) =>
     Hind:(pts.El
             pts.var
             (matita_arithmetics_nat.le
                (log p (matita_arithmetics_exp.exp n m0))
                (matita_arithmetics_nat.times m0 (matita_arithmetics_nat.S (log p n))))) =>
     matita_arithmetics_nat.transitive_le
       (log p (matita_arithmetics_exp.exp n (matita_arithmetics_nat.S m0)))
       (matita_arithmetics_nat.S
          (matita_arithmetics_nat.plus (log p n) (log p (matita_arithmetics_exp.exp n m0))))
       (matita_arithmetics_nat.times
          (matita_arithmetics_nat.S m0)
          (matita_arithmetics_nat.S (log p n)))
       (matita_basics_logic.eq_ind_r
          matita_arithmetics_nat.nat
          (matita_arithmetics_nat.times n (matita_arithmetics_exp.exp n m0))
          (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
           __:(pts.El
                 pts.var
                 (matita_basics_logic.eq
                    matita_arithmetics_nat.nat
                    x
                    (matita_arithmetics_nat.times n (matita_arithmetics_exp.exp n m0)))) =>
           matita_arithmetics_nat.le
             (log p x)
             (matita_arithmetics_nat.S
                (matita_arithmetics_nat.plus (log p n) (log p (matita_arithmetics_exp.exp n m0)))))
          (log_times p n (matita_arithmetics_exp.exp n m0) lt1p)
          (matita_arithmetics_nat.times (matita_arithmetics_exp.exp n m0) n)
          (matita_arithmetics_nat.commutative_times (matita_arithmetics_exp.exp n m0) n))
       (matita_arithmetics_nat.le_S_S
          (matita_arithmetics_nat.plus (log p n) (log p (matita_arithmetics_exp.exp n m0)))
          (matita_arithmetics_nat.plus
             (log p n)
             (matita_arithmetics_nat.times m0 (matita_arithmetics_nat.S (log p n))))
          (matita_arithmetics_nat.monotonic_le_plus_r
             (log p n)
             (log p (matita_arithmetics_exp.exp n m0))
             (matita_arithmetics_nat.times m0 (matita_arithmetics_nat.S (log p n)))
             Hind)))
    m.

def log_exp2 :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  m:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) ->
  __1:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O n)) ->
  pts.El
    pts.var
    (matita_arithmetics_nat.le
       (matita_arithmetics_nat.times m (log p n))
       (log p (matita_arithmetics_exp.exp n m)))
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  m:(pts.El pts.var matita_arithmetics_nat.nat) =>
  ltp1:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) =>
  posn:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O n)) =>
  matita_arithmetics_nat.le_S_S_to_le
    (matita_arithmetics_nat.times m (log p n))
    (log p (matita_arithmetics_exp.exp n m))
    (matita_arithmetics_exp.lt_exp_to_lt
       p
       (matita_arithmetics_nat.times m (log p n))
       (matita_arithmetics_nat.S (log p (matita_arithmetics_exp.exp n m)))
       (matita_arithmetics_nat.lt_to_le (matita_arithmetics_nat.S matita_arithmetics_nat.O) p ltp1)
       (matita_basics_logic.eq_ind_r
          matita_arithmetics_nat.nat
          (matita_arithmetics_nat.times (log p n) m)
          (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
           __:(pts.El
                 pts.var
                 (matita_basics_logic.eq
                    matita_arithmetics_nat.nat
                    x
                    (matita_arithmetics_nat.times (log p n) m))) =>
           matita_arithmetics_nat.lt
             (matita_arithmetics_exp.exp p x)
             (matita_arithmetics_exp.exp
                p
                (matita_arithmetics_nat.S (log p (matita_arithmetics_exp.exp n m)))))
          (matita_basics_logic.eq_ind
             matita_arithmetics_nat.nat
             (matita_arithmetics_exp.exp (matita_arithmetics_exp.exp p (log p n)) m)
             (x_1:(pts.El pts.var matita_arithmetics_nat.nat) =>
              _x_2:(pts.El
                      pts.var
                      (matita_basics_logic.eq
                         matita_arithmetics_nat.nat
                         (matita_arithmetics_exp.exp
                            (matita_arithmetics_exp.exp p (log p n))
                            m)
                         x_1)) =>
              matita_arithmetics_nat.lt
                x_1
                (matita_arithmetics_exp.exp
                   p
                   (matita_arithmetics_nat.S (log p (matita_arithmetics_exp.exp n m)))))
             (matita_arithmetics_nat.le_to_lt_to_lt
                (matita_arithmetics_exp.exp (matita_arithmetics_exp.exp p (log p n)) m)
                (matita_arithmetics_exp.exp n m)
                (matita_arithmetics_exp.exp
                   p
                   (matita_arithmetics_nat.S (log p (matita_arithmetics_exp.exp n m))))
                (matita_arithmetics_nat.nat_ind
                   (_x_365:(pts.El pts.var matita_arithmetics_nat.nat) =>
                    matita_arithmetics_nat.le
                      (matita_arithmetics_exp.exp
                         (matita_arithmetics_exp.exp p (log p n))
                         _x_365)
                      (matita_arithmetics_exp.exp n _x_365))
                   (matita_arithmetics_nat.le_n
                      (matita_arithmetics_exp.exp
                         (matita_arithmetics_exp.exp p (log p n))
                         matita_arithmetics_nat.O))
                   (m0:(pts.El pts.var matita_arithmetics_nat.nat) =>
                    Hind:(pts.El
                            pts.var
                            (matita_arithmetics_nat.le
                               (matita_arithmetics_exp.exp
                                  (matita_arithmetics_exp.exp p (log p n))
                                  m0)
                               (matita_arithmetics_exp.exp n m0))) =>
                    matita_arithmetics_nat.le_times
                      (matita_arithmetics_exp.exp (matita_arithmetics_exp.exp p (log p n)) m0)
                      (matita_arithmetics_exp.exp n m0)
                      (matita_arithmetics_exp.exp p (log p n))
                      n
                      Hind
                      (le_exp_log p n posn))
                   m)
                (lt_exp_log p (matita_arithmetics_exp.exp n m) ltp1))
             (matita_arithmetics_exp.exp p (matita_arithmetics_nat.times (log p n) m))
             (matita_arithmetics_exp.exp_exp_times p (log p n) m))
          (matita_arithmetics_nat.times m (log p n))
          (matita_arithmetics_nat.commutative_times m (log p n)))).

def le_log_S :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) ->
  pts.El pts.var (matita_arithmetics_nat.le (log p n) (log p (matita_arithmetics_nat.S n)))
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1p:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) =>
  matita_basics_bool.match_bool
    pts.var
    (__:(pts.El pts.var matita_basics_bool.bool) =>
     matita_arithmetics_nat.le
       (matita_arithmetics_minimization.max'
          n
          (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
           matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) n)
          matita_arithmetics_nat.O)
       (matita_basics_bool.match_bool
          pts.var
          (_0:(pts.El pts.var matita_basics_bool.bool) => matita_arithmetics_nat.nat)
          n
          (matita_arithmetics_minimization.max'
             n
             (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
              matita_arithmetics_nat.leb
                (matita_arithmetics_exp.exp p x)
                (matita_arithmetics_nat.S n))
             matita_arithmetics_nat.O)
          __))
    (matita_arithmetics_minimization.le_max_n
       (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
        matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) n)
       n)
    (matita_arithmetics_minimization.le_max_f_max_g
       (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
        matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) n)
       (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
        matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p x) (matita_arithmetics_nat.S n))
       n
       (i:(pts.El pts.var matita_arithmetics_nat.nat) =>
        ltin:(pts.El pts.var (matita_arithmetics_nat.lt i n)) =>
        H:(pts.El
             pts.var
             (matita_basics_logic.eq
                matita_basics_bool.bool
                (matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p i) n)
                matita_basics_bool.true)) =>
        matita_arithmetics_nat.le_to_leb_true
          (matita_arithmetics_exp.exp p i)
          (matita_arithmetics_nat.S n)
          (matita_arithmetics_nat.le_S
             (matita_arithmetics_exp.exp p i)
             n
             (matita_arithmetics_nat.leb_true_to_le
                (matita_arithmetics_exp.exp p i)
                n
                (matita_basics_logic.rewrite_r
                   matita_basics_bool.bool
                   matita_basics_bool.true
                   (__:(pts.El pts.var matita_basics_bool.bool) =>
                    matita_basics_logic.eq matita_basics_bool.bool __ matita_basics_bool.true)
                   (matita_basics_logic.refl matita_basics_bool.bool matita_basics_bool.true)
                   (matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p i) n)
                   H)))))
    (matita_arithmetics_nat.leb (matita_arithmetics_exp.exp p n) (matita_arithmetics_nat.S n)).

def le_log :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  m:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) ->
  __1:(pts.El pts.var (matita_arithmetics_nat.le n m)) ->
  pts.El pts.var (matita_arithmetics_nat.le (log p n) (log p m))
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  m:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1p:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) =>
  lenm:(pts.El pts.var (matita_arithmetics_nat.le n m)) =>
  matita_arithmetics_nat.le_ind
    n
    (x_417:(pts.El pts.var matita_arithmetics_nat.nat) =>
     _x_418:(pts.El pts.var (matita_arithmetics_nat.le n x_417)) =>
     matita_arithmetics_nat.le (log p n) (log p x_417))
    (matita_arithmetics_nat.le_n (log p n))
    (m0:(pts.El pts.var matita_arithmetics_nat.nat) =>
     lenm0:(pts.El pts.var (matita_arithmetics_nat.le n m0)) =>
     Hind:(pts.El pts.var (matita_arithmetics_nat.le (log p n) (log p m0))) =>
     matita_arithmetics_nat.transitive_le
       (log p n)
       (log p m0)
       (log p (matita_arithmetics_nat.S m0))
       Hind
       (le_log_S p m0 lt1p))
    m
    lenm.

def log_div :
  p:(pts.El pts.var matita_arithmetics_nat.nat) ->
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  m:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) ->
  __1:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O m)) ->
  __2:(pts.El pts.var (matita_arithmetics_nat.le m n)) ->
  pts.El
    pts.var
    (matita_arithmetics_nat.le
       (log p (matita_arithmetics_div_and_mod.div n m))
       (matita_arithmetics_nat.minus (log p n) (log p m)))
  :=
  p:(pts.El pts.var matita_arithmetics_nat.nat) =>
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  m:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1p:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) p)) =>
  posn:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O m)) =>
  lemn:(pts.El pts.var (matita_arithmetics_nat.le m n)) =>
  matita_arithmetics_nat.le_plus_to_minus_r
    (log p (matita_arithmetics_div_and_mod.div n m))
    (log p m)
    (log p n)
    (matita_arithmetics_nat.transitive_le
       (matita_arithmetics_nat.plus (log p (matita_arithmetics_div_and_mod.div n m)) (log p m))
       (log p (matita_arithmetics_nat.times (matita_arithmetics_div_and_mod.div n m) m))
       (log p n)
       (log_times_l
          p
          (matita_arithmetics_div_and_mod.div n m)
          m
          (matita_arithmetics_div_and_mod.le_times_to_le_div
             n
             m
             (matita_arithmetics_nat.S matita_arithmetics_nat.O)
             posn
             (matita_basics_logic.eq_coerc
                (matita_arithmetics_nat.le m n)
                (matita_arithmetics_nat.le
                   (matita_arithmetics_nat.times
                      m
                      (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                   n)
                lemn
                (matita_basics_logic.rewrite_l
                   matita_arithmetics_nat.nat
                   (matita_arithmetics_nat.plus
                      m
                      (matita_arithmetics_nat.times m matita_arithmetics_nat.O))
                   (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                    matita_basics_logic.eq
                      (pts.u pts.var)
                      (matita_arithmetics_nat.le m n)
                      (matita_arithmetics_nat.le __ n))
                   (matita_basics_logic.rewrite_l
                      matita_arithmetics_nat.nat
                      matita_arithmetics_nat.O
                      (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                       matita_basics_logic.eq
                         (pts.u pts.var)
                         (matita_arithmetics_nat.le m n)
                         (matita_arithmetics_nat.le (matita_arithmetics_nat.plus m __) n))
                      (matita_basics_logic.rewrite_l
                         matita_arithmetics_nat.nat
                         m
                         (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                          matita_basics_logic.eq
                            (pts.u pts.var)
                            (matita_arithmetics_nat.le m n)
                            (matita_arithmetics_nat.le __ n))
                         (matita_basics_logic.refl
                            (pts.u pts.var)
                            (matita_arithmetics_nat.le m n))
                         (matita_arithmetics_nat.plus m matita_arithmetics_nat.O)
                         (matita_arithmetics_nat.plus_n_O m))
                      (matita_arithmetics_nat.times m matita_arithmetics_nat.O)
                      (matita_arithmetics_nat.times_n_O m))
                   (matita_arithmetics_nat.times
                      m
                      (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                   (matita_arithmetics_nat.times_n_Sm m matita_arithmetics_nat.O))))
          posn
          lt1p)
       (le_log
          p
          (matita_arithmetics_nat.times (matita_arithmetics_div_and_mod.div n m) m)
          n
          lt1p
          (matita_basics_logic.eq_coerc
             (matita_arithmetics_nat.le
                (matita_arithmetics_nat.minus n (matita_arithmetics_div_and_mod.mod n m))
                n)
             (matita_arithmetics_nat.le
                (matita_arithmetics_nat.times (matita_arithmetics_div_and_mod.div n m) m)
                n)
             (matita_arithmetics_nat.minus_le n (matita_arithmetics_div_and_mod.mod n m))
             (matita_basics_logic.rewrite_r
                matita_arithmetics_nat.nat
                (matita_arithmetics_nat.times m (matita_arithmetics_div_and_mod.div n m))
                (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                 matita_basics_logic.eq
                   (pts.u pts.var)
                   (matita_arithmetics_nat.le
                      (matita_arithmetics_nat.minus n (matita_arithmetics_div_and_mod.mod n m))
                      n)
                   (matita_arithmetics_nat.le __ n))
                (matita_basics_logic.rewrite_l
                   matita_arithmetics_nat.nat
                   (matita_arithmetics_nat.times m (matita_arithmetics_div_and_mod.div n m))
                   (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                    matita_basics_logic.eq
                      (pts.u pts.var)
                      (matita_arithmetics_nat.le __ n)
                      (matita_arithmetics_nat.le
                         (matita_arithmetics_nat.times
                            m
                            (matita_arithmetics_div_and_mod.div n m))
                         n))
                   (matita_basics_logic.refl
                      (pts.u pts.var)
                      (matita_arithmetics_nat.le
                         (matita_arithmetics_nat.times
                            m
                            (matita_arithmetics_div_and_mod.div n m))
                         n))
                   (matita_arithmetics_nat.minus n (matita_arithmetics_div_and_mod.mod n m))
                   (matita_basics_logic.rewrite_l
                      matita_arithmetics_nat.nat
                      (matita_arithmetics_nat.times (matita_arithmetics_div_and_mod.div n m) m)
                      (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
                       matita_basics_logic.eq
                         matita_arithmetics_nat.nat
                         __
                         (matita_arithmetics_nat.minus
                            n
                            (matita_arithmetics_div_and_mod.mod n m)))
                      (matita_arithmetics_div_and_mod.eq_times_div_minus_mod n m)
                      (matita_arithmetics_nat.times m (matita_arithmetics_div_and_mod.div n m))
                      (matita_arithmetics_nat.commutative_times
                         (matita_arithmetics_div_and_mod.div n m)
                         m)))
                (matita_arithmetics_nat.times (matita_arithmetics_div_and_mod.div n m) m)
                (matita_arithmetics_nat.commutative_times
                   (matita_arithmetics_div_and_mod.div n m)
                   m))))).

def log_n_n :
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) n)) ->
  pts.El
    pts.var
    (matita_basics_logic.eq
       matita_arithmetics_nat.nat
       (log n n)
       (matita_arithmetics_nat.S matita_arithmetics_nat.O))
  :=
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1n:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) n)) =>
  matita_basics_logic.eq_ind_r
    matita_arithmetics_nat.nat
    (matita_arithmetics_exp.exp n (matita_arithmetics_nat.S matita_arithmetics_nat.O))
    (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
     __:(pts.El
           pts.var
           (matita_basics_logic.eq
              matita_arithmetics_nat.nat
              x
              (matita_arithmetics_exp.exp n (matita_arithmetics_nat.S matita_arithmetics_nat.O)))) =>
     matita_basics_logic.eq
       matita_arithmetics_nat.nat
       (log n x)
       (matita_arithmetics_nat.S matita_arithmetics_nat.O))
    (matita_basics_logic.eq_ind_r
       matita_arithmetics_nat.nat
       (matita_arithmetics_nat.times
          (matita_arithmetics_exp.exp n (matita_arithmetics_nat.S matita_arithmetics_nat.O))
          (matita_arithmetics_nat.S matita_arithmetics_nat.O))
       (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
        __:(pts.El
              pts.var
              (matita_basics_logic.eq
                 matita_arithmetics_nat.nat
                 x
                 (matita_arithmetics_nat.times
                    (matita_arithmetics_exp.exp
                       n
                       (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                    (matita_arithmetics_nat.S matita_arithmetics_nat.O)))) =>
        matita_basics_logic.eq
          matita_arithmetics_nat.nat
          (log n x)
          (matita_arithmetics_nat.S matita_arithmetics_nat.O))
       (matita_basics_logic.eq_ind_r
          matita_arithmetics_nat.nat
          (matita_arithmetics_nat.plus
             (matita_arithmetics_nat.S matita_arithmetics_nat.O)
             (log n (matita_arithmetics_nat.S matita_arithmetics_nat.O)))
          (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
           __:(pts.El
                 pts.var
                 (matita_basics_logic.eq
                    matita_arithmetics_nat.nat
                    x
                    (matita_arithmetics_nat.plus
                       (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                       (log n (matita_arithmetics_nat.S matita_arithmetics_nat.O))))) =>
           matita_basics_logic.eq
             matita_arithmetics_nat.nat
             x
             (matita_arithmetics_nat.S matita_arithmetics_nat.O))
          (matita_basics_logic.refl
             matita_arithmetics_nat.nat
             (matita_arithmetics_nat.plus
                (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                (log n (matita_arithmetics_nat.S matita_arithmetics_nat.O))))
          (log
             n
             (matita_arithmetics_nat.times
                (matita_arithmetics_exp.exp n (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                (matita_arithmetics_nat.S matita_arithmetics_nat.O)))
          (log_exp
             n
             (matita_arithmetics_nat.S matita_arithmetics_nat.O)
             (matita_arithmetics_nat.S matita_arithmetics_nat.O)
             lt1n
             (matita_arithmetics_nat.lt_O_S matita_arithmetics_nat.O)))
       (matita_arithmetics_exp.exp n (matita_arithmetics_nat.S matita_arithmetics_nat.O))
       (matita_arithmetics_nat.times_n_1
          (matita_arithmetics_exp.exp n (matita_arithmetics_nat.S matita_arithmetics_nat.O))))
    n
    (matita_arithmetics_exp.exp_n_1 n).

def log_i_2n :
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  i:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) n)) ->
  __1:(pts.El pts.var (matita_arithmetics_nat.lt n i)) ->
  __2:(pts.El
         pts.var
         (matita_arithmetics_nat.le
            i
            (matita_arithmetics_nat.times
               (matita_arithmetics_nat.S (matita_arithmetics_nat.S matita_arithmetics_nat.O))
               n))) ->
  pts.El
    pts.var
    (matita_basics_logic.eq
       matita_arithmetics_nat.nat
       (log
          i
          (matita_arithmetics_nat.times
             (matita_arithmetics_nat.S (matita_arithmetics_nat.S matita_arithmetics_nat.O))
             n))
       (matita_arithmetics_nat.S matita_arithmetics_nat.O))
  :=
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  i:(pts.El pts.var matita_arithmetics_nat.nat) =>
  lt1n:(pts.El
          pts.var
          (matita_arithmetics_nat.lt (matita_arithmetics_nat.S matita_arithmetics_nat.O) n)) =>
  ltni:(pts.El pts.var (matita_arithmetics_nat.lt n i)) =>
  lei:(pts.El
         pts.var
         (matita_arithmetics_nat.le
            i
            (matita_arithmetics_nat.times
               (matita_arithmetics_nat.S (matita_arithmetics_nat.S matita_arithmetics_nat.O))
               n))) =>
  matita_basics_logic.match_Or
    (matita_arithmetics_nat.lt
       (log
          i
          (matita_arithmetics_nat.times
             (matita_arithmetics_nat.S (matita_arithmetics_nat.S matita_arithmetics_nat.O))
             n))
       (matita_arithmetics_nat.S matita_arithmetics_nat.O))
    (matita_basics_logic.eq
       matita_arithmetics_nat.nat
       (log
          i
          (matita_arithmetics_nat.times
             (matita_arithmetics_nat.S (matita_arithmetics_nat.S matita_arithmetics_nat.O))
             n))
       (matita_arithmetics_nat.S matita_arithmetics_nat.O))
    pts.var
    (__:(pts.El
           pts.var
           (matita_basics_logic.Or
              (matita_arithmetics_nat.lt
                 (log
                    i
                    (matita_arithmetics_nat.times
                       (matita_arithmetics_nat.S
                          (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                       n))
                 (matita_arithmetics_nat.S matita_arithmetics_nat.O))
              (matita_basics_logic.eq
                 matita_arithmetics_nat.nat
                 (log
                    i
                    (matita_arithmetics_nat.times
                       (matita_arithmetics_nat.S
                          (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                       n))
                 (matita_arithmetics_nat.S matita_arithmetics_nat.O)))) =>
     matita_basics_logic.eq
       matita_arithmetics_nat.nat
       (log
          i
          (matita_arithmetics_nat.times
             (matita_arithmetics_nat.S (matita_arithmetics_nat.S matita_arithmetics_nat.O))
             n))
       (matita_arithmetics_nat.S matita_arithmetics_nat.O))
    (ltab:(pts.El
             pts.var
             (matita_arithmetics_nat.lt
                (log
                   i
                   (matita_arithmetics_nat.times
                      (matita_arithmetics_nat.S
                         (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                      n))
                (matita_arithmetics_nat.S matita_arithmetics_nat.O))) =>
     matita_basics_logic.False_ind
       (_x_66:(pts.El pts.var matita_basics_logic.False) =>
        matita_basics_logic.eq
          matita_arithmetics_nat.nat
          (log
             i
             (matita_arithmetics_nat.times
                (matita_arithmetics_nat.S (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                n))
          (matita_arithmetics_nat.S matita_arithmetics_nat.O))
       (matita_basics_logic.absurd
          (matita_arithmetics_nat.lt
             (log
                i
                (matita_arithmetics_nat.times
                   (matita_arithmetics_nat.S (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                   n))
             (matita_arithmetics_nat.S matita_arithmetics_nat.O))
          ltab
          (matita_arithmetics_nat.le_to_not_lt
             (matita_arithmetics_nat.S matita_arithmetics_nat.O)
             (log
                i
                (matita_arithmetics_nat.times
                   (matita_arithmetics_nat.S (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                   n))
             (matita_arithmetics_nat.transitive_le
                (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                (log i i)
                (log
                   i
                   (matita_arithmetics_nat.times
                      (matita_arithmetics_nat.S
                         (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                      n))
                (matita_basics_logic.eq_ind
                   matita_arithmetics_nat.nat
                   (log i i)
                   (x_1:(pts.El pts.var matita_arithmetics_nat.nat) =>
                    _x_2:(pts.El
                            pts.var
                            (matita_basics_logic.eq matita_arithmetics_nat.nat (log i i) x_1)) =>
                    matita_arithmetics_nat.le x_1 (log i i))
                   (matita_arithmetics_nat.le_n (log i i))
                   (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                   (log_n_n
                      i
                      (matita_arithmetics_nat.transitive_lt
                         (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                         n
                         i
                         lt1n
                         ltni)))
                (le_log
                   i
                   i
                   (matita_arithmetics_nat.times
                      (matita_arithmetics_nat.S
                         (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                      n)
                   (matita_arithmetics_nat.transitive_lt
                      (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                      n
                      i
                      lt1n
                      ltni)
                   lei)))))
    (auto:(pts.El
             pts.var
             (matita_basics_logic.eq
                matita_arithmetics_nat.nat
                (log
                   i
                   (matita_arithmetics_nat.times
                      (matita_arithmetics_nat.S
                         (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                      n))
                (matita_arithmetics_nat.S matita_arithmetics_nat.O))) =>
     matita_basics_logic.rewrite_l
       matita_arithmetics_nat.nat
       (log
          i
          (matita_arithmetics_nat.times
             (matita_arithmetics_nat.S (matita_arithmetics_nat.S matita_arithmetics_nat.O))
             n))
       (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
        matita_basics_logic.eq
          matita_arithmetics_nat.nat
          (log
             i
             (matita_arithmetics_nat.times
                (matita_arithmetics_nat.S (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                n))
          __)
       (matita_basics_logic.refl
          matita_arithmetics_nat.nat
          (log
             i
             (matita_arithmetics_nat.times
                (matita_arithmetics_nat.S (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                n)))
       (matita_arithmetics_nat.S matita_arithmetics_nat.O)
       auto)
    (matita_arithmetics_nat.le_to_or_lt_eq
       (log
          i
          (matita_arithmetics_nat.times
             (matita_arithmetics_nat.S (matita_arithmetics_nat.S matita_arithmetics_nat.O))
             n))
       (matita_arithmetics_nat.S matita_arithmetics_nat.O)
       (matita_arithmetics_nat.not_lt_to_le
          (matita_arithmetics_nat.S matita_arithmetics_nat.O)
          (log
             i
             (matita_arithmetics_nat.times
                (matita_arithmetics_nat.S (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                n))
          (matita_basics_logic.nmk
             (matita_arithmetics_nat.lt
                (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                (log
                   i
                   (matita_arithmetics_nat.times
                      (matita_arithmetics_nat.S
                         (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                      n)))
             (H:(pts.El
                   pts.var
                   (matita_arithmetics_nat.lt
                      (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                      (log
                         i
                         (matita_arithmetics_nat.times
                            (matita_arithmetics_nat.S
                               (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                            n)))) =>
              matita_basics_logic.absurd
                (matita_arithmetics_nat.le
                   (matita_arithmetics_exp.exp
                      i
                      (matita_arithmetics_nat.S
                         (matita_arithmetics_nat.S matita_arithmetics_nat.O)))
                   (matita_arithmetics_nat.times
                      (matita_arithmetics_nat.S
                         (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                      n))
                (matita_arithmetics_nat.transitive_le
                   (matita_arithmetics_exp.exp
                      i
                      (matita_arithmetics_nat.S
                         (matita_arithmetics_nat.S matita_arithmetics_nat.O)))
                   (matita_arithmetics_exp.exp
                      i
                      (log
                         i
                         (matita_arithmetics_nat.times
                            (matita_arithmetics_nat.S
                               (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                            n)))
                   (matita_arithmetics_nat.times
                      (matita_arithmetics_nat.S
                         (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                      n)
                   (matita_arithmetics_exp.le_exp
                      (matita_arithmetics_nat.S
                         (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                      (log
                         i
                         (matita_arithmetics_nat.times
                            (matita_arithmetics_nat.S
                               (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                            n))
                      i
                      (matita_arithmetics_nat.ltn_to_ltO n i ltni)
                      H)
                   (le_exp_log
                      i
                      (matita_arithmetics_nat.times
                         (matita_arithmetics_nat.S
                            (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                         n)
                      (matita_basics_logic.eq_ind_r
                         matita_arithmetics_nat.nat
                         (matita_arithmetics_nat.times
                            matita_arithmetics_nat.O
                            matita_arithmetics_nat.O)
                         (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                          __:(pts.El
                                pts.var
                                (matita_basics_logic.eq
                                   matita_arithmetics_nat.nat
                                   x
                                   (matita_arithmetics_nat.times
                                      matita_arithmetics_nat.O
                                      matita_arithmetics_nat.O))) =>
                          matita_arithmetics_nat.lt
                            x
                            (matita_arithmetics_nat.times
                               (matita_arithmetics_nat.S
                                  (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                               n))
                         (matita_arithmetics_nat.lt_times
                            matita_arithmetics_nat.O
                            (matita_arithmetics_nat.S
                               (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                            matita_arithmetics_nat.O
                            n
                            (matita_arithmetics_nat.lt_O_S
                               (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                            (matita_arithmetics_nat.lt_to_le
                               (matita_arithmetics_nat.S matita_arithmetics_nat.O)
                               n
                               lt1n))
                         matita_arithmetics_nat.O
                         (matita_arithmetics_nat.times_n_O matita_arithmetics_nat.O))))
                (matita_arithmetics_nat.lt_to_not_le
                   (matita_arithmetics_nat.times
                      (matita_arithmetics_nat.S
                         (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                      n)
                   (matita_arithmetics_exp.exp
                      i
                      (matita_arithmetics_nat.S
                         (matita_arithmetics_nat.S matita_arithmetics_nat.O)))
                   (matita_basics_logic.eq_ind_r
                      matita_arithmetics_nat.nat
                      (matita_arithmetics_nat.times i i)
                      (x:(pts.El pts.var matita_arithmetics_nat.nat) =>
                       __:(pts.El
                             pts.var
                             (matita_basics_logic.eq
                                matita_arithmetics_nat.nat
                                x
                                (matita_arithmetics_nat.times i i))) =>
                       matita_arithmetics_nat.lt
                         (matita_arithmetics_nat.times
                            (matita_arithmetics_nat.S
                               (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                            n)
                         x)
                      (matita_arithmetics_nat.lt_times
                         (matita_arithmetics_nat.S
                            (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                         i
                         n
                         i
                         (matita_arithmetics_nat.le_to_lt_to_lt
                            (matita_arithmetics_nat.S
                               (matita_arithmetics_nat.S matita_arithmetics_nat.O))
                            n
                            i
                            lt1n
                            ltni)
                         (matita_arithmetics_nat.le_to_lt_to_lt
                            n
                            n
                            i
                            (matita_arithmetics_nat.le_n n)
                            ltni))
                      (matita_arithmetics_exp.exp
                         i
                         (matita_arithmetics_nat.S
                            (matita_arithmetics_nat.S matita_arithmetics_nat.O)))
                      (matita_arithmetics_exp.exp_2 i))))))).

def exp_n_O :
  n:(pts.El pts.var matita_arithmetics_nat.nat) ->
  __:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O n)) ->
  pts.El
    pts.var
    (matita_basics_logic.eq
       matita_arithmetics_nat.nat
       (matita_arithmetics_exp.exp matita_arithmetics_nat.O n)
       matita_arithmetics_nat.O)
  :=
  n:(pts.El pts.var matita_arithmetics_nat.nat) =>
  posn:(pts.El pts.var (matita_arithmetics_nat.lt matita_arithmetics_nat.O n)) =>
  matita_arithmetics_nat.lt_O_n_elim
    n
    posn
    (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
     matita_basics_logic.eq
       matita_arithmetics_nat.nat
       (matita_arithmetics_exp.exp matita_arithmetics_nat.O __)
       matita_arithmetics_nat.O)
    (m:(pts.El pts.var matita_arithmetics_nat.nat) =>
     matita_basics_logic.rewrite_r
       matita_arithmetics_nat.nat
       (matita_arithmetics_nat.times
          matita_arithmetics_nat.O
          (matita_arithmetics_exp.exp matita_arithmetics_nat.O m))
       (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
        matita_basics_logic.eq matita_arithmetics_nat.nat __ matita_arithmetics_nat.O)
       (matita_basics_logic.rewrite_l
          matita_arithmetics_nat.nat
          matita_arithmetics_nat.O
          (__:(pts.El pts.var matita_arithmetics_nat.nat) =>
           matita_basics_logic.eq matita_arithmetics_nat.nat __ matita_arithmetics_nat.O)
          (matita_basics_logic.refl matita_arithmetics_nat.nat matita_arithmetics_nat.O)
          (matita_arithmetics_nat.times
             matita_arithmetics_nat.O
             (matita_arithmetics_exp.exp matita_arithmetics_nat.O m))
          (matita_arithmetics_nat.times_O_n (matita_arithmetics_exp.exp matita_arithmetics_nat.O m)))
       (matita_arithmetics_nat.times
          (matita_arithmetics_exp.exp matita_arithmetics_nat.O m)
          matita_arithmetics_nat.O)
       (matita_arithmetics_nat.commutative_times
          (matita_arithmetics_exp.exp matita_arithmetics_nat.O m)
          matita_arithmetics_nat.O)).

